# External URLs and Integrations

Check these external services after rename:

./dist/assets/index-C-FEraip.js:499:      `,children:e})},Ty=({expenses:e,onPageChange:r})=>{const s=e.slice(0,5);return t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-3 sm:p-4 sm:p-5 md:p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Recent Expenses"}),t.jsx("button",{onClick:()=>r("expenses"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"View All"})]}),s.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(kt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"No expenses yet"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Submit your first expense to get started"})]}):t.jsx("div",{className:"space-y-4",children:s.map(n=>t.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[t.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 md:space-x-4",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full flex items-center justify-center",children:t.jsx(kt,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("p",{className:"font-medium text-gray-900",children:n.merchant}),n.event_name&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:[t.jsx(Mt,{className:"w-3 h-3"}),n.event_name]})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[t.jsx(hr,{className:"w-3 h-3"}),t.jsx("span",{children:xt(n.date)}),n.location&&t.jsxs(t.Fragment,{children:[t.jsx(Ls,{className:"w-3 h-3 ml-2"}),t.jsx("span",{children:n.location})]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(mu,{category:n.category,size:"sm"}),t.jsx(ud,{status:n.status,size:"sm"}),t.jsxs("p",{className:"font-semibold text-gray-900",children:["$",n.amount.toFixed(2)]})]})]},n.id))})]})},Ry=({events:e,onPageChange:r})=>{const s=new Date;s.setHours(0,0,0,0);const n=e.filter(i=>or(i.endDate)>=s).sort((i,c)=>{const m=or(i.startDate),d=or(c.startDate);return m.getTime()-d.getTime()}).slice(0,3),a=i=>i===0?"Today":i===1?"1 day":`${i} days`;return t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upcoming Events"}),t.jsx("button",{onClick:()=>r("events"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"View All"})]}),n.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Mt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"No upcoming events"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create your first trade show event"})]}):t.jsx("div",{className:"space-y-4",children:n.map(i=>{var y;const c=or(i.startDate),m=or(i.endDate),d=new Date;d.setHours(0,0,0,0);const N=d>=c&&d<=m?0:ky(i.startDate);return t.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-sm transition-shadow",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsx("h4",{className:"font-semibold text-gray-900",children:i.name}),t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${N===0?"bg-orange-100 text-orange-800":N<=7?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:a(N)})]}),t.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(Ls,{className:"w-4 h-4 mr-2"}),t.jsxs("span",{children:[i.venue,", ",i.city,", ",i.state]})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),t.jsx("span",{children:zx(i.startDate,i.endDate)})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(Nr,{className:"w-4 h-4 mr-2"}),t.jsxs("span",{children:[((y=i.participants)==null?void 0:y.length)||0," participants"]})]})]}),i.budget&&t.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Budget"}),t.jsxs("span",{className:"font-medium text-gray-900",children:["$",i.budget.toLocaleString()]})]})})]},i.id)})})]})},Ay=({events:e,expenses:r})=>{const s=C.useMemo(()=>e.filter(a=>a.budget&&a.budget>0).map(a=>{const i=r.filter(p=>p.tradeShowId===a.id),c=i.reduce((p,N)=>p+N.amount,0),m=a.budget||0,d=m>0?c/m*100:0;return{...a,budget:m,totalSpent:c,budgetUsed:d,remaining:m-c,expenseCount:i.length}}).slice(0,4),[e,r]),n=a=>a>=90?{color:"red",status:"Critical",icon:bt}:a>=75?{color:"orange",status:"Warning",icon:bt}:{color:"emerald",status:"Good",icon:ut};return t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-3 sm:p-4 sm:p-5 md:p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Budget Overview"}),t.jsx(ts,{className:"w-5 h-5 text-blue-600"})]}),s.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(ut,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"No budget data available"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create events and add expenses to see budget tracking"})]}):t.jsx("div",{className:"space-y-6",children:s.map(a=>{const i=n(a.budgetUsed),c=i.icon;return t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900",children:a.name}),t.jsxs("p",{className:"text-sm text-gray-600",children:[a.expenseCount," expenses submitted"]})]}),t.jsxs("div",{className:`flex items-center space-x-1 text-sm font-medium ${i.color==="red"?"text-red-600":i.color==="orange"?"text-orange-600":"text-emerald-600"}`,children:[t.jsx(c,{className:"w-4 h-4"}),t.jsx("span",{children:i.status})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{className:"text-gray-600",children:["Spent: $",a.totalSpent.toLocaleString()]}),t.jsxs("span",{className:"text-gray-600",children:["Budget: $",a.budget.toLocaleString()]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${i.color==="red"?"bg-red-500":i.color==="orange"?"bg-orange-500":"bg-emerald-500"}`,style:{width:`${Math.min(a.budgetUsed,100)}%`}})}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{className:`font-medium ${i.color==="red"?"text-red-600":i.color==="orange"?"text-orange-600":"text-emerald-600"}`,children:[a.budgetUsed.toFixed(1),"% used"]}),t.jsxs("span",{className:"text-gray-600",children:["$",a.remaining.toLocaleString()," remaining"]})]})]})]},a.id)})})]})},Dy=!0,se={USE_SERVER:Dy,login:async(e,r)=>{const s=await ge.post("/auth/login",{username:e,password:r});return s!=null&&s.token&&Vt.setToken(s.token),s},logout:()=>{Vt.removeToken()},getUsers:()=>ge.get("/users"),createUser:e=>ge.post("/users",e),updateUser:(e,r)=>ge.put(`/users/${e}`,r),deleteUser:e=>ge.delete(`/users/${e}`),getRoles:()=>ge.get("/roles"),createRole:e=>ge.post("/roles",e),updateRole:(e,r)=>ge.put(`/roles/${e}`,r),deleteRole:e=>ge.delete(`/roles/${e}`),getEvents:()=>ge.get("/events"),createEvent:e=>ge.post("/events",e),updateEvent:(e,r)=>ge.put(`/events/${e}`,r),deleteEvent:e=>ge.delete(`/events/${e}`),getExpenses:e=>ge.get("/expenses",{params:e}),createExpense:async(e,r)=>r?ge.upload("/expenses",e,r,"receipt"):ge.post("/expenses",e),updateExpense:async(e,r,s)=>s?ge.upload(`/expenses/${e}`,r,s,"receipt","PUT"):ge.put(`/expenses/${e}`,r),updateExpenseReceipt:async(e,r)=>ge.upload(`/expenses/${e}/receipt`,{},r,"receipt","PUT"),updateExpenseStatus:(e,r)=>ge.patch(`/expenses/${e}/status`,r),reviewExpense:(e,r)=>ge.patch(`/expenses/${e}/review`,r),assignEntity:(e,r)=>ge.patch(`/expenses/${e}/entity`,r),pushToZoho:e=>ge.post(`/expenses/${e}/push-to-zoho`,{}),setExpenseReimbursement:(e,r)=>ge.patch(`/expenses/${e}/reimbursement`,r),deleteExpense:e=>ge.delete(`/expenses/${e}`),downloadExpensePDF:async e=>{console.log("[downloadExpensePDF] Starting PDF download for expense:",e);const r=Vt.getToken();if(!r)throw new Error("Authentication required. Please log in again.");const s=ge.getBaseURL(),n=window.location.protocol,a=window.location.origin;let i=`${s}/expenses/${e}/pdf`;console.log("[downloadExpensePDF] URL info:",{baseURL:s,pdfUrl:i,currentProtocol:n,currentOrigin:a,isRelative:!i.startsWith("http")}),n==="https:"&&i.startsWith("http://")&&(i=i.replace("http://","https://"),console.warn("[downloadExpensePDF] Upgraded HTTP to HTTPS to avoid mixed content warning"));const c=navigator.userAgent.toLowerCase(),m=c.includes("arc")||c.includes("the browser company"),d=c.includes("chrome")&&!c.includes("edg");console.log("[downloadExpensePDF] Browser detection:",{isArc:m,isChrome:d,userAgent:c.substring(0,50)});try{console.log("[downloadExpensePDF] Fetching PDF from:",i);const p=await fetch(i,{method:"GET",headers:{Authorization:`Bearer ${r}`},credentials:"same-origin"});if(console.log("[downloadExpensePDF] Response status:",p.status,p.statusText),console.log("[downloadExpensePDF] Response headers:",{"content-type":p.headers.get("content-type"),"content-disposition":p.headers.get("content-disposition"),"content-length":p.headers.get("content-length"),"x-content-type-options":p.headers.get("x-content-type-options"),"x-download-options":p.headers.get("x-download-options")}),!p.ok){const F=await p.text();let T="Failed to download expense PDF";try{const R=JSON.parse(F);T=R.error||R.message||T}catch{T=F||T}throw console.error("[downloadExpensePDF] HTTP error:",p.status,T),new Error(T)}const N=p.headers.get("content-type");(!N||!N.includes("application/pdf"))&&(console.error("[downloadExpensePDF] Invalid Content-Type:",N),console.warn("[downloadExpensePDF] Expected application/pdf but got:",N));const y=p.headers.get("content-disposition");let f=`expense-${e}.pdf`;if(y){const F=y.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);F&&F[1]&&(f=F[1].replace(/['"]/g,""))}console.log("[downloadExpensePDF] Filename:",f),console.log("[downloadExpensePDF] Converting response to blob...");const k=await p.blob();if(console.log("[downloadExpensePDF] Blob created:",{size:k.size,type:k.type}),k.size===0)throw new Error("Downloaded PDF is empty. Please try again.");const E=await k.slice(0,4).arrayBuffer(),_=new Uint8Array(E),w=String.fromCharCode(..._);if(console.log("[downloadExpensePDF] PDF header check:",{header:w,bytes:Array.from(_).map(F=>`0x${F.toString(16).padStart(2,"0")}`).join(" ")}),!w.startsWith("%PDF")){console.error("[downloadExpensePDF] Invalid PDF header. First 4 bytes:",w);try{const F=await k.text();console.error("[downloadExpensePDF] Response text (first 200 chars):",F.substring(0,200));try{const T=JSON.parse(F);throw new Error(T.error||T.message||"Downloaded file is not a valid PDF")}catch{throw new Error("Downloaded file is not a valid PDF. Please check server logs.")}}catch{throw new Error("Downloaded file is not a valid PDF. Please check server logs.")}}console.log("[downloadExpensePDF] PDF header validated successfully");const j=k.type==="application/pdf"?k:new Blob([k],{type:"application/pdf"});console.log("[downloadExpensePDF] PDF blob ready:",{size:j.size,type:j.type});const g=window.URL.createObjectURL(j);console.log("[downloadExpensePDF] Blob URL created:",g.substring(0,50)+"...");let v=null,A=!1;try{if(v=document.createElement("a"),v.href=g,v.download=f,v.style.display="none",v.setAttribute("rel","noopener noreferrer"),m&&(v.setAttribute("target","_self"),console.log("[downloadExpensePDF] Arc browser detected - using Arc-specific settings")),document.body.appendChild(v),console.log("[downloadExpensePDF] Link appended to DOM"),await new Promise(T=>setTimeout(T,m?100:50)),console.log("[downloadExpensePDF] Triggering download..."),typeof v.click=="function")v.click(),console.log("[downloadExpensePDF] Used link.click() method");else{const T=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0,buttons:1});v.dispatchEvent(T),console.log("[downloadExpensePDF] Used MouseEvent dispatch method")}A=!0,console.log("[downloadExpensePDF] Download triggered successfully"),setTimeout(()=>{try{v&&document.body.contains(v)&&(document.body.removeChild(v),console.log("[downloadExpensePDF] Link removed from DOM")),window.URL.revokeObjectURL(g),console.log("[downloadExpensePDF] Blob URL revoked")}catch(T){console.warn("[downloadExpensePDF] Cleanup error (non-critical):",T)}},m?2e3:1e3)}catch(F){if(console.error("[downloadExpensePDF] Error during download trigger:",F),v&&document.body.contains(v))try{document.body.removeChild(v)}catch(R){console.warn("[downloadExpensePDF] Error removing link:",R)}window.URL.revokeObjectURL(g);const T=F instanceof Error?F.message:"Unknown error";throw console.error("[downloadExpensePDF] Download failed:",T),new Error(`Failed to download PDF: ${T}. Please check your browser settings or try a different browser.`)}if(!A)throw new Error("Download trigger failed. Please check browser console for details.")}catch(p){throw console.error("[downloadExpensePDF] Fatal error:",p),p}},getSettings:()=>ge.get("/settings"),updateSettings:e=>ge.put("/settings",e),processReceiptWithOCR:async e=>{const r=Vt.getToken();if(!r)throw new Error("Authentication required. Please log in again.");const s=await fetch(`${ge.getBaseURL()}/ocr/v2/process`,{method:"POST",headers:{Authorization:`Bearer ${r}`},body:e});if(!s.ok){const n=await s.text();throw console.error("[OCR] Processing failed:",n),new Error("OCR processing failed")}return await s.json()},getBaseURL:()=>ge.getBaseURL(),register:e=>ge.post("/auth/register",e),checkAvailability:e=>ge.post("/auth/check-availability",e),quickActions:{getTasks:()=>ge.get("/quick-actions")},devDashboard:{getVersion:()=>ge.get("/dev-dashboard/version"),getMetrics:e=>ge.get("/dev-dashboard/metrics",{params:{timeRange:e}}),getAuditLogs:e=>ge.get("/dev-dashboard/audit-logs",{params:e}),getSessions:()=>ge.get("/dev-dashboard/sessions"),getApiAnalytics:e=>ge.get("/dev-dashboard/api-analytics",{params:{timeRange:e}}),getAlerts:(e,r)=>ge.get("/dev-dashboard/alerts",{params:{status:e,severity:r}}),acknowledgeAlert:e=>ge.post(`/dev-dashboard/alerts/${e}/acknowledge`),resolveAlert:e=>ge.post(`/dev-dashboard/alerts/${e}/resolve`),getPageAnalytics:e=>ge.get("/dev-dashboard/page-analytics",{params:{timeRange:e}}),getSummary:()=>ge.get("/dev-dashboard/summary"),getOcrMetrics:()=>ge.get("/dev-dashboard/ocr-metrics")},checklist:{getChecklist:e=>ge.get(`/checklist/${e}`),updateChecklist:(e,r)=>ge.put(`/checklist/${e}`,r),uploadBoothMap:async(e,r)=>{const s=new FormData;s.append("boothMap",r);const n=Vt.getToken(),a=await fetch(`${ge.getBaseURL()}/checklist/${e}/booth-map`,{method:"POST",headers:{Authorization:`Bearer ${n}`},body:s});if(!a.ok){const i=await a.text();throw new Error(i||"Failed to upload booth map")}return await a.json()},deleteBoothMap:e=>ge.delete(`/checklist/${e}/booth-map`),createFlight:(e,r)=>ge.post(`/checklist/${e}/flights`,r),updateFlight:(e,r)=>ge.put(`/checklist/flights/${e}`,r),deleteFlight:e=>ge.delete(`/checklist/flights/${e}`),createHotel:(e,r)=>ge.post(`/checklist/${e}/hotels`,r),updateHotel:(e,r)=>ge.put(`/checklist/hotels/${e}`,r),deleteHotel:e=>ge.delete(`/checklist/hotels/${e}`),createCarRental:(e,r)=>ge.post(`/checklist/${e}/car-rentals`,r),updateCarRental:(e,r)=>ge.put(`/checklist/car-rentals/${e}`,r),deleteCarRental:e=>ge.delete(`/checklist/car-rentals/${e}`),createBoothShipping:(e,r)=>ge.post(`/checklist/${e}/booth-shipping`,r),updateBoothShipping:(e,r)=>ge.put(`/checklist/booth-shipping/${e}`,r),deleteBoothShipping:e=>ge.delete(`/checklist/booth-shipping/${e}`),getCustomItems:e=>ge.get(`/checklist/${e}/custom-items`),createCustomItem:(e,r)=>ge.post(`/checklist/${e}/custom-items`,r),updateCustomItem:(e,r)=>ge.put(`/checklist/custom-items/${e}`,r),deleteCustomItem:e=>ge.delete(`/checklist/custom-items/${e}`),getTemplates:()=>ge.get("/checklist/templates"),createTemplate:e=>ge.post("/checklist/templates",e),updateTemplate:(e,r)=>ge.put(`/checklist/templates/${e}`,r),deleteTemplate:e=>ge.delete(`/checklist/templates/${e}`),applyTemplates:e=>ge.post(`/checklist/${e}/apply-templates`,{})}},My=({user:e,onNavigate:r})=>{const[s,n]=C.useState([]),[a,i]=C.useState(!0),[c,m]=C.useState(!1),d=async(f=!1)=>{f?m(!0):i(!0);try{const k=await se.quickActions.getTasks();n(k.tasks||[])}catch(k){console.error("Failed to load quick actions:",k)}finally{i(!1),m(!1)}};C.useEffect(()=>{d();const f=setInterval(()=>d(!0),6e4);return()=>clearInterval(f)},[]);const p=f=>({UserPlus:t.jsx(Ix,{className:"w-5 h-5"}),FileText:t.jsx(Yt,{className:"w-5 h-5"}),Upload:t.jsx(is,{className:"w-5 h-5"}),AlertTriangle:t.jsx(bt,{className:"w-5 h-5"}),Clock:t.jsx(hr,{className:"w-5 h-5"}),DollarSign:t.jsx(kt,{className:"w-5 h-5"})})[f]||t.jsx(Yt,{className:"w-5 h-5"}),N=f=>{switch(f){case"high":return"border-red-200 bg-red-50";case"medium":return"border-yellow-200 bg-yellow-50";default:return"border-blue-200 bg-blue-50"}},y=f=>{switch(f){case"high":return"bg-red-100 text-red-700";case"medium":return"bg-yellow-100 text-yellow-700";default:return"bg-blue-100 text-blue-700"}};return a?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"})}),t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})})]}):t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Pending Tasks"}),t.jsx("button",{onClick:()=>d(!0),disabled:c,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50",title:"Refresh",children:t.jsx(Ir,{className:`w-4 h-4 ${c?"animate-spin":""}`})})]}),s.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:t.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("p",{className:"text-gray-600 font-medium",children:"All caught up!"}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No pending tasks at the moment"})]}):t.jsx("div",{className:"space-y-3",children:s.map(f=>t.jsx("div",{className:`border-2 rounded-lg p-4 transition-all hover:shadow-md ${N(f.priority)}`,children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[t.jsx("div",{className:`mt-1 ${f.priority==="high"?"text-red-600":f.priority==="medium"?"text-yellow-600":"text-blue-600"}`,children:p(f.icon)}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:f.title}),t.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${y(f.priority)}`,children:f.priority})]}),t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:f.description}),t.jsxs("button",{onClick:()=>{const k=f.link.replace("/","");f.type==="pending_users"&&k==="settings"&&sessionStorage.setItem("openSettingsTab","users"),r(k)},className:`inline-flex items-center text-sm font-medium transition-colors ${f.priority==="high"?"text-red-600 hover:text-red-700":f.priority==="medium"?"text-yellow-600 hover:text-yellow-700":"text-blue-600 hover:text-blue-700"}`,children:[f.action,t.jsx(Ex,{className:"w-4 h-4 ml-1"})]})]})]})})},f.id))})]})},Fy=()=>{const[e,r]=C.useState(null),[s,n]=C.useState(!1),[a,i]=C.useState(!1);C.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches)return;const p=localStorage.getItem("pwa-install-dismissed");if(p){const y=parseInt(p);if((Date.now()-y)/(1e3*60*60*24)<7)return}const N=y=>{y.preventDefault(),r(y),n(!0),setTimeout(()=>{i(!0)},1e4)};return window.addEventListener("beforeinstallprompt",N),()=>{window.removeEventListener("beforeinstallprompt",N)}},[]);const c=async()=>{if(!e){alert(`To install this app:
./dist/assets/index-C-FEraip.js:502:Android: Tap Menu → Install App`);return}e.prompt(),(await e.userChoice).outcome==="accepted"&&console.log("User accepted the install prompt"),r(null),n(!1),i(!1)},m=()=>{i(!1),localStorage.setItem("pwa-install-dismissed",Date.now().toString())};return s?a?t.jsxs("div",{className:"fixed bottom-4 left-4 right-4 md:left-auto md:w-96 bg-white rounded-xl shadow-2xl border-2 border-blue-500 p-4 z-50 animate-slide-up",children:[t.jsx("button",{onClick:m,className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600",children:t.jsx(Me,{className:"w-4 h-4"})}),t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-lg flex items-center justify-center",children:t.jsx(Is,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:"Install App"}),t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Add to your home screen for quick access and offline support"}),t.jsxs("div",{className:"flex space-x-2",children:[t.jsx("button",{onClick:c,className:"flex-1 bg-gradient-to-r from-blue-500 to-emerald-500 text-white px-4 py-2 rounded-lg text-sm font-medium hover:from-blue-600 hover:to-emerald-600 transition-all",children:"Install"}),t.jsx("button",{onClick:m,className:"px-4 py-2 text-gray-600 text-sm font-medium hover:bg-gray-100 rounded-lg transition-colors",children:"Not now"})]})]})]})]}):t.jsxs("button",{onClick:c,className:"inline-flex items-center space-x-2 px-4 py-2 bg-white border-2 border-blue-500 text-blue-600 rounded-lg font-medium hover:bg-blue-50 transition-all duration-200 shadow-sm hover:shadow-md",children:[t.jsx(Is,{className:"w-4 h-4"}),t.jsx("span",{className:"hidden sm:inline",children:"Add to Home Screen"}),t.jsx("span",{className:"sm:hidden",children:"Install"})]}):null};function Oy(){const[e,r]=C.useState([]),[s,n]=C.useState([]),[a,i]=C.useState([]),[c,m]=C.useState(!0);return C.useEffect(()=>{let d=!0;return(async()=>{console.log("[Dashboard] Loading data...");try{const N=await se.getExpenses();d&&(console.log("[Dashboard] Loaded expenses:",(N==null?void 0:N.length)||0),r(N||[]))}catch(N){const y=N;if(console.error("[Dashboard] Error loading expenses:",y),d&&r([]),(y==null?void 0:y.statusCode)===401||(y==null?void 0:y.statusCode)===403){console.error("[Dashboard] Authentication failed, stopping data load"),d&&m(!1);return}}try{const N=await se.getEvents();d&&(console.log("[Dashboard] Loaded events:",(N==null?void 0:N.length)||0),n(N||[]))}catch(N){const y=N;if(console.error("[Dashboard] Error loading events:",y),d&&n([]),(y==null?void 0:y.statusCode)===401||(y==null?void 0:y.statusCode)===403){console.error("[Dashboard] Authentication failed, stopping data load"),d&&m(!1);return}}try{const N=await se.getUsers();d&&(console.log("[Dashboard] Loaded users:",(N==null?void 0:N.length)||0),i(N||[]))}catch(N){console.error("[Dashboard] Error loading users (non-critical):",N),d&&i([])}d&&m(!1)})(),()=>{d=!1}},[]),{expenses:e,events:s,users:a,loading:c}}function Iy({expenses:e,events:r,users:s,currentUser:n}){return C.useMemo(()=>{const i=n.role==="admin"||n.role==="developer"||n.role==="accountant",c=n.role==="admin"||n.role==="developer"||n.role==="accountant"||n.role==="coordinator",m=i?e:e.filter(k=>k.userId===n.id),d=c?r:r.filter(k=>k.participants.some(S=>S.id===n.id)),p=m.reduce((k,S)=>k+(S.amount||0),0),N=m.filter(k=>k.status==="pending").length,y=new Date;y.setHours(0,0,0,0);const f=d.filter(k=>or(k.endDate)>=y).length;return{totalExpenses:p,pendingExpenses:N,upcomingEvents:f,activeEvents:f,totalEvents:d.length,averageExpense:m.length>0?p/m.length:0,teamMembers:s.length,userExpenses:m,userEvents:d}},[e,r,s,n.id,n.role])}const Ly=({user:e,onPageChange:r})=>{const{expenses:s,events:n,users:a}=Oy(),i=Iy({expenses:s,events:n,users:a,currentUser:e}),c=()=>{const m=new Date().getHours();return m<12?"Good morning":m<18?"Good afternoon":"Good evening"};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"bg-gradient-to-r from-blue-500 to-emerald-500 rounded-2xl text-white p-4 md:p-6 lg:p-8",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{children:[t.jsxs("h1",{className:"text-3xl font-bold mb-2",children:[c(),", ",e.name.split(" ")[0],"!"]}),t.jsxs("p",{className:"text-blue-100",children:[e.role==="coordinator"&&"Manage your trade shows and track expenses",e.role==="salesperson"&&"Submit your expenses and view your activity",e.role==="accountant"&&"Review expenses and manage entity mappings",e.role==="admin"&&"Oversee all operations and manage users",e.role==="developer"&&"Full system access with dev tools",e.role==="temporary"&&"View trade show information and dashboard"]})]}),t.jsx("div",{className:"hidden md:block",children:t.jsx("div",{className:"w-32 h-32 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:t.jsx(Mt,{className:"w-16 h-16 text-white"})})})]}),t.jsx("div",{className:"flex justify-start",children:t.jsx(Fy,{})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:[t.jsx(uc,{title:e.role==="admin"||e.role==="developer"||e.role==="accountant"?"Total Expenses":"My Expenses",value:`$${i.totalExpenses.toLocaleString()}`,icon:kt,color:"blue"}),t.jsx(uc,{title:e.role==="admin"||e.role==="developer"||e.role==="accountant"?"Pending Approvals":"My Pending Approvals",value:i.pendingExpenses.toString(),icon:bt,color:"orange"}),t.jsx(uc,{title:e.role==="admin"||e.role==="developer"||e.role==="accountant"||e.role==="coordinator"?"Active Events":"My Active Events",value:i.activeEvents.toString(),icon:Mt,color:"emerald"})]}),t.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"xl:col-span-2 space-y-6",children:[t.jsx(Ty,{expenses:i.userExpenses,onPageChange:r}),(e.role==="admin"||e.role==="developer"||e.role==="accountant")&&t.jsx(Ay,{events:i.userEvents,expenses:i.userExpenses})]}),t.jsxs("div",{className:"space-y-6",children:[t.jsx(Ry,{events:i.userEvents,onPageChange:r}),t.jsx(My,{user:e,onNavigate:r})]})]})]})};function Uy(){const[e,r]=C.useState([]),[s,n]=C.useState([]),[a,i]=C.useState(!0),[c,m]=C.useState(null),d=async()=>{i(!0);{try{console.log("[EventSetup] Fetching events from API...");const p=await se.getEvents();console.log("[EventSetup] Received events:",(p==null?void 0:p.length)||0,"events"),r(p||[]),m(null)}catch(p){const N=p instanceof Error?p.message:"Unknown error";console.error("[EventSetup] Error fetching events:",p),m(`Failed to load events: ${N}`),r([])}try{console.log("[EventSetup] Fetching users from API...");const p=await se.getUsers();console.log("[EventSetup] Received users:",(p==null?void 0:p.length)||0,"users"),(!p||p.length===0)&&console.warn("[EventSetup] ⚠️ NO USERS RETURNED FROM API!"),n(p||[]),console.log("[EventSetup] allUsers state updated with",(p==null?void 0:p.length)||0,"users")}catch(p){console.error("[EventSetup] ❌ ERROR fetching users:",p),n([])}}i(!1)};return C.useEffect(()=>{d()},[]),{events:e,allUsers:s,loading:a,loadError:c,reload:d}}function rl(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const r=Math.random()*16|0;return(e==="x"?r:r&3|8).toString(16)})}const lh={name:"",venue:"",city:"",state:"",startDate:"",endDate:"",showStartDate:"",showEndDate:"",travelStartDate:"",travelEndDate:"",budget:"",participants:[]};function zy(){const[e,r]=C.useState(lh),[s,n]=C.useState(null),[a,i]=C.useState(""),[c,m]=C.useState(""),[d,p]=C.useState(""),N=()=>{r(lh),m(""),p(""),n(null),i("")};return{formData:e,setFormData:r,editingEvent:s,selectedUserId:a,setSelectedUserId:i,newParticipantName:c,setNewParticipantName:m,newParticipantEmail:d,setNewParticipantEmail:p,handleSubmit:async(_,w,j)=>{_.preventDefault();const g={name:e.name,venue:e.venue,city:e.city,state:e.state,startDate:e.showStartDate,endDate:e.showEndDate,showStartDate:e.showStartDate,showEndDate:e.showEndDate,travelStartDate:e.travelStartDate,travelEndDate:e.travelEndDate,budget:e.budget?parseFloat(e.budget):void 0,participants:e.participants,status:"upcoming",coordinatorId:w};try{se.USE_SERVER&&(s?await se.updateEvent(s.id,{name:g.name,venue:g.venue,city:g.city,state:g.state,start_date:g.showStartDate,end_date:g.showEndDate,show_start_date:g.showStartDate,show_end_date:g.showEndDate,travel_start_date:g.travelStartDate,travel_end_date:g.travelEndDate,budget:g.budget,participants:g.participants,status:g.status||"upcoming"}):(console.log("[useEventForm] About to create event with participants:",g.participants),console.log("[useEventForm] Participants details:",g.participants.map(v=>({id:v.id,name:v.name,username:v.username,email:v.email,role:v.role,roleType:typeof v.role}))),await se.createEvent({name:g.name,venue:g.venue,city:g.city,state:g.state,start_date:g.showStartDate,end_date:g.showEndDate,show_start_date:g.showStartDate,show_end_date:g.showEndDate,travel_start_date:g.travelStartDate,travel_end_date:g.travelEndDate,budget:g.budget,participants:g.participants}))),j(),N()}catch(v){throw console.error("[useEventForm] Error submitting event:",v),v}},handleEdit:_=>{var w;n(_),r({name:_.name,venue:_.venue,city:_.city,state:_.state,startDate:bs(_.showStartDate||_.startDate),endDate:bs(_.showEndDate||_.endDate),showStartDate:bs(_.showStartDate||_.startDate),showEndDate:bs(_.showEndDate||_.endDate),travelStartDate:bs(_.travelStartDate||_.startDate),travelEndDate:bs(_.travelEndDate||_.endDate),budget:((w=_.budget)==null?void 0:w.toString())||"",participants:_.participants})},resetForm:N,addParticipant:_=>{if(a&&!e.participants.find(w=>w.id===a)){const w=_.find(j=>j.id===a);w&&(r({...e,participants:[...e.participants,w]}),i(""))}},addCustomParticipant:()=>{if(c&&d&&!e.participants.find(_=>_.email===d)){const _={id:rl(),name:c,username:c.split(" ")[0].toLowerCase(),email:d,role:"temporary"};r({...e,participants:[...e.participants,_]}),m(""),p("")}},removeParticipant:_=>{r({...e,participants:e.participants.filter(w=>w.id!==_)})}}}function $y(){const[e,r]=C.useState(null),[s,n]=C.useState(!1),a=C.useCallback(async(i,c)=>{n(!0);try{const m=await se.checklist.getChecklist(i);if(console.log("[useChecklistSummary] Raw API response:",m),!m||typeof m!="object"){console.warn("[useChecklistSummary] Invalid data received from API"),r(null);return}const d=m,p=typeof d.booth_map_url=="string"&&d.booth_map_url.trim()!==""?d.booth_map_url:null;console.log("[useChecklistSummary] Extracted booth_map_url:",p),r({booth_ordered:typeof d.booth_ordered=="boolean"?d.booth_ordered:!1,electricity_ordered:typeof d.electricity_ordered=="boolean"?d.electricity_ordered:!1,flights_booked:Array.isArray(d.flights)?d.flights.filter(N=>N.booked).length:0,flights_total:c,hotels_booked:Array.isArray(d.hotels)?d.hotels.filter(N=>N.booked).length:0,hotels_total:c,car_rentals_booked:Array.isArray(d.carRentals)?d.carRentals.filter(N=>N.booked).length:0,car_rentals_total:Array.isArray(d.carRentals)?d.carRentals.length:0,booth_shipped:Array.isArray(d.boothShipping)&&d.boothShipping.length>0&&d.boothShipping[0].shipped||!1,booth_map_url:p,flights:Array.isArray(d.flights)?d.flights:[],hotels:Array.isArray(d.hotels)?d.hotels:[],carRentals:Array.isArray(d.carRentals)?d.carRentals:[]}),console.log("[useChecklistSummary] Normalized checklist data:",{booth_map_url:p,booth_ordered:typeof d.booth_ordered=="boolean"?d.booth_ordered:!1})}catch(m){console.error("[useChecklistSummary] Error loading checklist:",m),r(null)}finally{n(!1)}},[]);return{checklistData:e,loadingChecklist:s,loadChecklistSummary:a}}const By=({user:e,viewMode:r,setViewMode:s,filterMode:n,setFilterMode:a,activeEventsCount:i,pastEventsCount:c})=>{const m=e.role==="admin"||e.role==="developer"||e.role==="accountant"||e.role==="coordinator";return t.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-1 inline-flex",children:[t.jsxs("button",{onClick:()=>s("active"),className:`px-6 py-2 rounded-lg font-medium transition-all duration-200 ${r==="active"?"bg-gradient-to-r from-blue-500 to-emerald-500 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:["Active Events (",i,")"]}),t.jsxs("button",{onClick:()=>s("past"),className:`px-6 py-2 rounded-lg font-medium transition-all duration-200 ${r==="past"?"bg-gradient-to-r from-blue-500 to-emerald-500 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:["Past Events (",c,")"]})]}),m&&t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-1 inline-flex",children:[t.jsx("button",{onClick:()=>a("all"),className:`px-6 py-2 rounded-lg font-medium transition-all duration-200 ${n==="all"?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"All Events"}),t.jsx("button",{onClick:()=>a("my"),className:`px-6 py-2 rounded-lg font-medium transition-all duration-200 ${n==="my"?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"My Events"})]})]})},qy=({user:e,allUsers:r,showForm:s,isSaving:n,formData:a,setFormData:i,editingEvent:c,selectedUserId:m,setSelectedUserId:d,newParticipantName:p,setNewParticipantName:N,newParticipantEmail:y,setNewParticipantEmail:f,onClose:k,onSubmit:S,onAddParticipant:E,onAddCustomParticipant:_,onRemoveParticipant:w,onResetForm:j})=>{var g;return s?t.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto p-4 md:p-6 lg:p-8",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0 mb-8",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl md:text-2xl font-bold text-gray-900",children:c?"Edit Event":"Create New Event"}),t.jsx("p",{className:"text-gray-600",children:"Set up your trade show details and invite participants"})]}),t.jsx("button",{onClick:()=>{k(),j()},className:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors",children:t.jsx(Me,{className:"w-5 h-5"})})]}),t.jsxs("form",{onSubmit:S,className:"space-y-8",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-5 lg:gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Event Name *"}),t.jsx("input",{type:"text",required:!0,value:a.name,onChange:v=>i({...a,name:v.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., CES 2025"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Venue *"}),t.jsx("input",{type:"text",required:!0,value:a.venue,onChange:v=>i({...a,venue:v.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Las Vegas Convention Center"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City *"}),t.jsx("input",{type:"text",required:!0,value:a.city,onChange:v=>i({...a,city:v.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Las Vegas"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"State *"}),t.jsx("input",{type:"text",required:!0,value:a.state,onChange:v=>i({...a,state:v.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"e.g., Nevada"})]}),t.jsx("div",{className:"col-span-2",children:t.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-3 flex items-center",children:[t.jsx("span",{className:"inline-block w-2 h-2 bg-blue-500 rounded-full mr-2"}),"Show Dates"]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Show Start Date *"}),t.jsx("input",{type:"date",required:!0,value:a.showStartDate,onChange:v=>i({...a,showStartDate:v.target.value,startDate:v.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Show End Date *"}),t.jsx("input",{type:"date",required:!0,value:a.showEndDate,min:a.showStartDate,onChange:v=>i({...a,showEndDate:v.target.value,endDate:v.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"}),a.showStartDate&&a.showEndDate&&a.showEndDate<a.showStartDate&&t.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Show end date cannot be before show start date"})]}),t.jsx("div",{className:"col-span-2",children:t.jsxs("h3",{className:"text-md font-semibold text-gray-800 mb-3 mt-2 flex items-center",children:[t.jsx("span",{className:"inline-block w-2 h-2 bg-green-500 rounded-full mr-2"}),"Travel Dates"]})}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Travel Start Date *"}),t.jsx("input",{type:"date",required:!0,value:a.travelStartDate,onChange:v=>i({...a,travelStartDate:v.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Travel End Date *"}),t.jsx("input",{type:"date",required:!0,value:a.travelEndDate,min:a.travelStartDate,onChange:v=>i({...a,travelEndDate:v.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"}),a.travelStartDate&&a.travelEndDate&&a.travelEndDate<a.travelStartDate&&t.jsx("p",{className:"mt-1 text-sm text-red-600",children:"Travel end date cannot be before travel start date"})]})]}),(e.role==="admin"||e.role==="developer"||e.role==="accountant")&&t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Budget (Optional)"}),t.jsx("input",{type:"number",step:"0.01",value:a.budget,onChange:v=>i({...a,budget:v.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter budget amount"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Participants"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select from existing users"}),t.jsxs("div",{className:"flex gap-3",children:[t.jsxs("select",{value:m,onChange:v=>d(v.target.value),className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[t.jsx("option",{value:"",children:"Select a user..."}),r.filter(v=>!a.participants.find(A=>A.id===v.id)).map(v=>t.jsxs("option",{value:v.id,children:[v.name," (",v.email,")"]},v.id))]}),t.jsxs("button",{type:"button",onClick:E,disabled:!m,className:"bg-blue-500 text-white px-4 sm:px-5 md:px-6 py-2.5 sm:py-3 min-h-[44px] rounded-lg font-medium hover:bg-blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[t.jsx(Lr,{className:"w-5 h-5"}),t.jsx("span",{children:"Add"})]})]})]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 flex items-center",children:t.jsx("div",{className:"w-full border-t border-gray-300"})}),t.jsx("div",{className:"relative flex justify-center text-sm",children:t.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or add new participant"})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsx("input",{type:"text",value:p,onChange:v=>N(v.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Full name"}),t.jsx("input",{type:"email",value:y,onChange:v=>f(v.target.value),className:"px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Email address"})]}),t.jsx("div",{className:"flex justify-end",children:t.jsxs("button",{type:"button",onClick:_,disabled:!p||!y,className:"bg-emerald-500 text-white px-4 sm:px-5 md:px-6 py-2.5 sm:py-3 min-h-[44px] rounded-lg font-medium hover:bg-emerald-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[t.jsx(Lr,{className:"w-5 h-5"}),t.jsx("span",{children:"Add New"})]})})]}),(((g=a.participants)==null?void 0:g.length)||0)>0&&t.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:t.jsx("div",{className:"space-y-2",children:a.participants.map(v=>t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0 bg-white p-3 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full flex items-center justify-center",children:t.jsx("span",{className:"text-white text-sm font-medium",children:v.name.charAt(0).toUpperCase()})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:v.name}),t.jsx("p",{className:"text-sm text-gray-600",children:v.email})]})]}),t.jsx("button",{type:"button",onClick:()=>w(v.id),className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:t.jsx(Ur,{className:"w-4 h-4"})})]},v.id))})})]}),t.jsxs("div",{className:"flex items-center justify-end space-x-4 pt-6 border-t border-gray-200",children:[t.jsx("button",{type:"button",onClick:()=>{k(),j()},className:"px-4 sm:px-5 md:px-6 py-2.5 sm:py-3 min-h-[44px] border border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),t.jsx("button",{type:"submit",disabled:n,className:"bg-gradient-to-r from-blue-500 to-emerald-500 text-white px-8 py-3 rounded-lg font-medium hover:from-blue-600 hover:to-emerald-600 transition-all duration-200 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:n?t.jsxs(t.Fragment,{children:[t.jsx(Sr,{className:"w-5 h-5 animate-spin"}),t.jsx("span",{children:"Saving..."})]}):t.jsx("span",{children:c?"Update Event":"Create Event"})})]})]})]})}):null},Vy=({events:e,user:r,canManageEvents:s,onViewDetails:n,onEdit:a,onDelete:i})=>e.length===0?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[t.jsx(Mt,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No events found"}),t.jsx("p",{className:"text-gray-500",children:"Create your first trade show event to get started."})]}):t.jsx("div",{className:"grid gap-4 md:gap-5 lg:gap-6",children:e.map(c=>{var m;return t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-4 md:p-5 lg:p-6",children:[t.jsxs("div",{className:"flex justify-between items-start mb-4",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:c.name}),t.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 mt-2",children:[t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Ls,{className:"w-4 h-4"}),c.venue,", ",c.city,", ",c.state]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(Mt,{className:"w-4 h-4"}),zx(c.startDate,c.endDate)]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[c.budget&&(r.role==="admin"||r.role==="developer"||r.role==="accountant")&&t.jsxs("div",{className:"flex items-center gap-1 text-emerald-600",children:[t.jsx(kt,{className:"w-4 h-4"}),t.jsxs("span",{className:"font-medium",children:["$",c.budget.toLocaleString()]})]}),t.jsxs("button",{onClick:()=>n(c),className:"px-3 py-1 text-gray-700 hover:bg-gray-100 rounded-lg transition-colors text-sm font-medium flex items-center gap-1",children:[t.jsx(Oi,{className:"w-4 h-4"}),"Details"]}),s&&t.jsxs(t.Fragment,{children:[t.jsx("button",{onClick:()=>a(c),className:"px-3 py-1 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors text-sm font-medium",children:"Edit"}),t.jsx("button",{onClick:()=>i(c.id),className:"px-3 py-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors text-sm font-medium",children:"Delete"})]})]})]}),t.jsxs("div",{className:"relative inline-block group",children:[t.jsxs("div",{className:"flex items-center gap-1 text-sm text-gray-600 cursor-help",children:[t.jsx(Nr,{className:"w-4 h-4"}),t.jsxs("span",{children:[((m=c.participants)==null?void 0:m.length)||0," participants"]})]}),c.participants&&c.participants.length>0&&t.jsxs("div",{className:"absolute left-0 top-full mt-2 bg-white border border-gray-200 rounded-lg shadow-lg p-3 z-10 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 min-w-[200px]",children:[t.jsx("div",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Participants:"}),t.jsx("div",{className:"space-y-1",children:c.participants.map((d,p)=>t.jsxs("div",{className:"text-sm text-gray-600 flex items-center gap-2",children:[t.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),d.name]},p))})]})]})]},c.id)})}),Hy=({user:e,checklistData:r,loadingChecklist:s})=>{var c,m;if(s)return t.jsx("div",{className:"flex items-center justify-center py-4",children:t.jsx(Sr,{className:"w-5 h-5 animate-spin text-gray-400"})});if(!r)return t.jsx("p",{className:"text-gray-500 text-sm italic",children:"Checklist not available"});const n=(c=r.flights)==null?void 0:c.find(d=>d.attendee_id===e.id),a=(m=r.hotels)==null?void 0:m.find(d=>d.attendee_id===e.id),i=r.carRentals||[];return t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 space-y-3",children:[t.jsx("h4",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide mb-2",children:"Overall Status"}),t.jsxs("div",{className:"flex items-center gap-3",children:[r.booth_ordered?t.jsx(ct,{className:"w-5 h-5 text-green-600 flex-shrink-0"}):t.jsx(wr,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Booth Space Ordered"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[r.electricity_ordered?t.jsx(ct,{className:"w-5 h-5 text-green-600 flex-shrink-0"}):t.jsx(wr,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Electricity Ordered"})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(od,{className:"w-5 h-5 text-blue-600 flex-shrink-0"}),t.jsxs("span",{className:"text-sm text-gray-700",children:["Flights: ",r.flights_booked,"/",r.flights_total," booked"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ld,{className:"w-5 h-5 text-emerald-600 flex-shrink-0"}),t.jsxs("span",{className:"text-sm text-gray-700",children:["Hotels: ",r.hotels_booked,"/",r.hotels_total," booked"]})]}),r.car_rentals_total>0&&t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(ad,{className:"w-5 h-5 text-orange-600 flex-shrink-0"}),t.jsxs("span",{className:"text-sm text-gray-700",children:["Car Rentals: ",r.car_rentals_booked,"/",r.car_rentals_total," booked"]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[r.booth_shipped?t.jsx(ct,{className:"w-5 h-5 text-green-600 flex-shrink-0"}):t.jsx(wr,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Booth Shipped"})]})]}),(n||a||i.length>0)&&t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-3",children:[t.jsxs("h4",{className:"text-xs font-semibold text-blue-900 uppercase tracking-wide mb-2 flex items-center gap-2",children:[t.jsx(hy,{className:"w-4 h-4"}),"Your Travel Details"]}),n&&t.jsxs("div",{className:"bg-white rounded-lg p-3 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(od,{className:"w-4 h-4 text-blue-600"}),t.jsx("span",{className:"font-medium text-gray-900 text-sm",children:"Flight"}),n.booked&&t.jsx(ct,{className:"w-4 h-4 text-green-600 ml-auto"})]}),n.carrier&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Carrier:"}),t.jsx("span",{className:"text-gray-900 ml-2",children:n.carrier})]}),n.confirmation_number&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Confirmation:"}),t.jsx("span",{className:"text-gray-900 ml-2 font-mono",children:n.confirmation_number})]}),n.notes&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Notes:"}),t.jsx("span",{className:"text-gray-900 ml-2",children:n.notes})]})]}),a&&t.jsxs("div",{className:"bg-white rounded-lg p-3 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(ld,{className:"w-4 h-4 text-emerald-600"}),t.jsx("span",{className:"font-medium text-gray-900 text-sm",children:"Hotel"}),a.booked&&t.jsx(ct,{className:"w-4 h-4 text-green-600 ml-auto"})]}),a.property_name&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Property:"}),t.jsx("span",{className:"text-gray-900 ml-2",children:a.property_name})]}),a.confirmation_number&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Confirmation:"}),t.jsx("span",{className:"text-gray-900 ml-2 font-mono",children:a.confirmation_number})]}),(a.check_in_date||a.check_out_date)&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Dates:"}),t.jsxs("span",{className:"text-gray-900 ml-2",children:[a.check_in_date?xt(a.check_in_date):"—"," to ",a.check_out_date?xt(a.check_out_date):"—"]})]}),a.notes&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Notes:"}),t.jsx("span",{className:"text-gray-900 ml-2",children:a.notes})]})]}),i.map(d=>t.jsxs("div",{className:"bg-white rounded-lg p-3 space-y-2",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx(ad,{className:"w-4 h-4 text-orange-600"}),t.jsx("span",{className:"font-medium text-gray-900 text-sm",children:"Car Rental"}),d.booked&&t.jsx(ct,{className:"w-4 h-4 text-green-600 ml-auto"})]}),d.provider&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Provider:"}),t.jsx("span",{className:"text-gray-900 ml-2",children:d.provider})]}),d.confirmation_number&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Confirmation:"}),t.jsx("span",{className:"text-gray-900 ml-2 font-mono",children:d.confirmation_number})]}),(d.pickup_date||d.return_date)&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Dates:"}),t.jsxs("span",{className:"text-gray-900 ml-2",children:[d.pickup_date?xt(d.pickup_date):"—"," to ",d.return_date?xt(d.return_date):"—"]})]}),d.notes&&t.jsxs("div",{className:"text-sm",children:[t.jsx("span",{className:"text-gray-500",children:"Notes:"}),t.jsx("span",{className:"text-gray-900 ml-2",children:d.notes})]})]},d.id))]})]})},Bx=({boothMapUrl:e,isOpen:r,onClose:s})=>{const[n,a]=C.useState(!1),[i,c]=C.useState(!0);if(C.useEffect(()=>{r&&e&&(a(!1),c(!0))},[r,e]),C.useEffect(()=>{if(!r)return;const k=S=>{S.key==="Escape"&&s()};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[r,s]),!r)return null;if(!e||typeof e!="string")return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Booth Floor Plan"}),t.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close",children:t.jsx(Me,{className:"w-5 h-5 text-gray-500"})})]}),t.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(st,{className:"w-12 h-12 text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500",children:"Invalid booth map URL"})]})]})});const p=`https://expapp.duckdns.org/api${e.startsWith("/")?e:`/${e}`}`,N=()=>{c(!1),a(!1)},y=()=>{console.error("[BoothMapViewer] Failed to load booth map image:",p),a(!0),c(!1)},f=k=>{k.target===k.currentTarget&&s()};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[9999] p-4",onClick:f,children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-6xl w-full max-h-[90vh] flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(ay,{className:"w-5 h-5 text-gray-600"}),t.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Booth Floor Plan"})]}),t.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Close",children:t.jsx(Me,{className:"w-5 h-5 text-gray-500"})})]}),t.jsxs("div",{className:"flex-1 overflow-auto p-6 flex items-center justify-center bg-gray-50",children:[i&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(Sr,{className:"w-8 h-8 animate-spin text-gray-400 mb-4"}),t.jsx("p",{className:"text-sm text-gray-500",children:"Loading image..."})]}),n&&t.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[t.jsx(st,{className:"w-12 h-12 text-gray-400 mb-4"}),t.jsx("p",{className:"text-gray-500 mb-2",children:"Failed to load booth map image"}),t.jsx("p",{className:"text-xs text-gray-400 text-center max-w-md",children:"The image could not be loaded. Please check the URL or try again later."})]}),!n&&t.jsx("img",{src:p,alt:"Booth Floor Plan",className:`max-w-full max-h-[calc(90vh-120px)] object-contain rounded-lg shadow-lg ${i?"hidden":""}`,onLoad:N,onError:y})]}),t.jsx("div",{className:"p-4 border-t border-gray-200 bg-gray-50 rounded-b-xl",children:t.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Click outside the image or press Escape to close"})})]})})},Ky=({boothMapUrl:e,onViewFullSize:r})=>{const[s,n]=C.useState(!1),[a,i]=C.useState(!0);if(!e||typeof e!="string")return t.jsxs("div",{className:"w-full h-48 bg-gray-50 rounded border border-gray-200 flex flex-col items-center justify-center p-4",children:[t.jsx(st,{className:"w-8 h-8 text-gray-400 mb-2"}),t.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Invalid booth map URL"})]});const d=`https://expapp.duckdns.org/api${e.startsWith("/")?e:`/${e}`}`,p=()=>{i(!1),n(!1)},N=()=>{console.error("[EventDetailsModal] Failed to load booth map image:",d),n(!0),i(!1)};return s?t.jsxs("div",{className:"w-full h-48 bg-gray-50 rounded border border-gray-200 flex flex-col items-center justify-center p-4",children:[t.jsx(st,{className:"w-8 h-8 text-gray-400 mb-2"}),t.jsx("p",{className:"text-xs text-gray-500 text-center",children:"Failed to load booth map image"})]}):t.jsxs(t.Fragment,{children:[a&&t.jsx("div",{className:"w-full h-48 bg-gray-50 rounded border border-gray-200 flex items-center justify-center",children:t.jsx(Sr,{className:"w-6 h-6 animate-spin text-gray-400"})}),t.jsx("img",{src:d,alt:"Booth Floor Plan",className:`w-full h-48 object-contain bg-gray-50 rounded border border-gray-200 cursor-pointer hover:opacity-90 transition-opacity ${a?"hidden":""}`,onClick:r,onLoad:p,onError:N,title:"Click to view full size"}),!a&&!s&&t.jsx("p",{className:"text-xs text-gray-500 mt-1 text-center",children:"Click image to view full size"})]})},Wy=({event:e,user:r,checklistData:s,loadingChecklist:n,onClose:a})=>{var m;const[i,c]=C.useState(!1);return t.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:[t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center",children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:e.name}),t.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:t.jsx(Me,{className:"w-5 h-5 text-gray-500"})})]}),t.jsxs("div",{className:"p-6 space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Location"}),t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(Ls,{className:"w-5 h-5 text-gray-400 mt-0.5"}),t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-900 font-medium",children:e.venue}),t.jsxs("p",{className:"text-gray-600",children:[e.city,", ",e.state]})]})]})]}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-2 flex items-center gap-2",children:[t.jsx("span",{className:"inline-block w-2 h-2 bg-blue-500 rounded-full"}),"Show Dates"]}),t.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-blue-900",children:[t.jsx(Mt,{className:"w-5 h-5"}),t.jsxs("span",{className:"font-medium",children:[xt(e.showStartDate||e.startDate)," - ",xt(e.showEndDate||e.endDate)]})]}),t.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Actual event/trade show dates"})]})]}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-2 flex items-center gap-2",children:[t.jsx("span",{className:"inline-block w-2 h-2 bg-green-500 rounded-full"}),"Travel Dates"]}),t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 text-green-900",children:[t.jsx(Mt,{className:"w-5 h-5"}),t.jsxs("span",{className:"font-medium",children:[xt(e.travelStartDate||e.startDate)," - ",xt(e.travelEndDate||e.endDate)]})]}),t.jsx("p",{className:"text-sm text-green-700 mt-1",children:"When team members travel for the event"})]})]}),e.budget&&(r.role==="admin"||r.role==="developer"||r.role==="accountant")&&t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-2",children:"Budget"}),t.jsxs("div",{className:"flex items-center gap-2 text-emerald-600",children:[t.jsx(kt,{className:"w-5 h-5"}),t.jsxs("span",{className:"text-2xl font-bold",children:["$",e.budget.toLocaleString()]})]})]}),t.jsxs("div",{children:[t.jsxs("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:["Participants (",((m=e.participants)==null?void 0:m.length)||0,")"]}),e.participants&&e.participants.length>0?t.jsx("div",{className:"space-y-2",children:e.participants.map(d=>t.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 p-3 rounded-lg",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full flex items-center justify-center flex-shrink-0",children:t.jsx("span",{className:"text-white font-medium",children:d.name.charAt(0).toUpperCase()})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium text-gray-900 truncate",children:d.name}),t.jsx("p",{className:"text-sm text-gray-600 truncate",children:d.email})]}),t.jsx("span",{className:"px-2.5 py-1 bg-gray-200 text-gray-700 rounded-full text-xs font-medium capitalize flex-shrink-0",children:d.role})]},d.id))}):t.jsx("p",{className:"text-gray-500 italic",children:"No participants assigned yet"})]}),!n&&(s==null?void 0:s.booth_map_url)&&t.jsxs("div",{children:[t.jsxs("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-2 flex items-center gap-2",children:[t.jsx("span",{className:"inline-block w-2 h-2 bg-purple-500 rounded-full"}),"Booth Floor Plan"]}),t.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[t.jsx(Mx,{className:"w-5 h-5 text-purple-600"}),t.jsx("span",{className:"font-medium text-purple-900",children:"Booth Layout"})]}),t.jsx(Ky,{boothMapUrl:s.booth_map_url,onViewFullSize:()=>c(!0)})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-sm font-medium text-gray-500 uppercase tracking-wide mb-3",children:"Event Checklist"}),t.jsx(Hy,{user:r,checklistData:s,loadingChecklist:n})]})]}),t.jsx("div",{className:"sticky bottom-0 bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-end",children:t.jsx("button",{onClick:a,className:"px-6 py-2.5 bg-gray-900 text-white rounded-lg font-medium hover:bg-gray-800 transition-colors",children:"Close"})})]}),(s==null?void 0:s.booth_map_url)&&t.jsx(Bx,{boothMapUrl:s.booth_map_url,isOpen:i,onClose:()=>c(!1)})]})},Qy=({user:e})=>{const{events:r,allUsers:s,loadError:n,reload:a}=Uy(),{formData:i,setFormData:c,editingEvent:m,selectedUserId:d,setSelectedUserId:p,newParticipantName:N,setNewParticipantName:y,newParticipantEmail:f,setNewParticipantEmail:k,handleSubmit:S,handleEdit:E,resetForm:_,addParticipant:w,addCustomParticipant:j,removeParticipant:g}=zy(),[v,A]=C.useState(!1),[F,T]=C.useState("active"),[R,K]=C.useState("all"),[J,O]=C.useState(!1),[Y,Q]=C.useState(null),{checklistData:X,loadingChecklist:fe,loadChecklistSummary:Ce}=$y();C.useEffect(()=>{var be;if(Y){console.log("[EventSetup] Loading checklist for event:",Y.id);const Se=((be=Y.participants)==null?void 0:be.length)||0;Ce(Y.id,Se)}else console.log("[EventSetup] Clearing checklist data (modal closed)")},[Y==null?void 0:Y.id,Ce]);const Pe=async be=>{if(!J){O(!0);try{await S(be,e.id,async()=>{await a(),A(!1)})}catch(Se){console.error("[EventSetup] Error saving event:",Se),alert("Failed to save event. Please try again.")}finally{O(!1)}}},re=async be=>{await se.deleteEvent(be),await a()},ie=be=>{E(be),A(!0)},te=()=>{w(s)},ce=new Date;ce.setHours(0,0,0,0);const ae=r.filter(be=>e.role==="admin"||e.role==="developer"?R==="all"?!0:be.participants.some(Se=>Se.id===e.id):e.role==="coordinator"?!0:e.role==="accountant"?R==="all"?!0:be.participants.some(Se=>Se.id===e.id):be.participants.some(Se=>Se.id===e.id));console.log("[EventSetup] Total events:",r.length),console.log("[EventSetup] After role filter:",ae.length),console.log("[EventSetup] Today:",ce.toISOString());const me=ae.filter(be=>{try{const Se=or(be.endDate);return console.log(`[EventSetup] Event "${be.name}": endDate=${be.endDate}, parsed=${Se.toISOString()}, isActive=${Se>=ce}`),Se>=ce}catch(Se){return console.error(`[EventSetup] Error parsing date for event "${be.name}":`,Se),!1}}),_e=ae.filter(be=>{try{return or(be.endDate)<ce}catch(Se){return console.error(`[EventSetup] Error parsing date for event "${be.name}":`,Se),!1}});console.log("[EventSetup] Active events:",me.length),console.log("[EventSetup] Past events:",_e.length);const Le=F==="active"?me:_e,ye=e.role==="admin"||e.role==="developer"||e.role==="coordinator";return t.jsxs("div",{className:"space-y-6",children:[n&&t.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg",children:[t.jsx("p",{className:"font-semibold",children:"Error Loading Events"}),t.jsx("p",{className:"text-sm mt-1",children:n}),t.jsx("p",{className:"text-xs mt-2 text-red-600",children:"Check browser console (F12) for more details"})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:e.role==="coordinator"?"Event Management":"Events"}),t.jsx("p",{className:"text-gray-600 mt-1",children:e.role==="coordinator"?"Create and manage trade show events":e.role==="admin"||e.role==="developer"?"View all events and participants, manage settings":e.role==="accountant"?"View all events and participants for transparency":"View events you are assigned to"})]}),ye&&t.jsxs("button",{onClick:()=>A(!0),className:"bg-gradient-to-r from-blue-500 to-emerald-500 text-white px-4 sm:px-5 md:px-6 py-2.5 sm:py-3 min-h-[44px] rounded-lg font-medium hover:from-blue-600 hover:to-emerald-600 transition-all duration-200 flex items-center space-x-2",children:[t.jsx(Lr,{className:"w-5 h-5"}),t.jsx("span",{children:"Create Event"})]})]}),t.jsx(By,{user:e,viewMode:F,setViewMode:T,filterMode:R,setFilterMode:K,activeEventsCount:me.length,pastEventsCount:_e.length}),t.jsx(qy,{user:e,allUsers:s,showForm:v,isSaving:J,formData:i,setFormData:c,editingEvent:m,selectedUserId:d,setSelectedUserId:p,newParticipantName:N,setNewParticipantName:y,newParticipantEmail:f,setNewParticipantEmail:k,onClose:()=>A(!1),onSubmit:Pe,onAddParticipant:te,onAddCustomParticipant:j,onRemoveParticipant:g,onResetForm:_}),t.jsx(Vy,{events:Le,user:e,canManageEvents:ye,onViewDetails:Q,onEdit:ie,onDelete:re}),Y&&t.jsx(Wy,{event:Y,user:e,checklistData:X,loadingChecklist:fe,onClose:()=>Q(null)})]})},ih={booth:"Booth / Marketing / Tools",electricity:"Booth / Marketing / Tools",flight:"Travel - Flight",hotel:"Accommodation - Hotel",car_rental:"Rental - Car / U-haul",booth_shipping:"Shipping Charges"},io=({user:e,event:r,section:s,attendeeName:n,onClose:a,onExpenseCreated:i})=>{const[c,m]=C.useState(null),[d,p]=C.useState(!1),[N,y]=C.useState(null),[f,k]=C.useState([]),[S,E]=C.useState({merchant:"",amount:"",date:new Date().toISOString().split("T")[0],description:n?`${n} - ${s}`:s==="electricity"?"Electricity":s==="booth"?"Booth":s==="booth_shipping"?"Booth Shipping":s.replace(/_/g," "),cardUsed:"",zohoEntity:"",receiptUrl:""}),_=C.useRef(null);Xs.useEffect(()=>{(async()=>{try{const g=await se.getSettings();k(g.cardOptions||[])}catch(g){console.error("[ChecklistReceiptUpload] Failed to load card options:",g),k([])}})()},[]);const w=async g=>{var v;m(g),p(!0);try{const A=new FormData;A.append("receipt",g);const F=await se.processReceiptWithOCR(A);console.log("[ChecklistReceiptUpload] OCR response:",F),y(F);const T=F.fields||{},R=(v=T.cardLastFour)==null?void 0:v.value,K=R?f.find(J=>J.lastFour===R):null;E(J=>{var O,Y,Q,X;return{...J,merchant:((O=T.merchant)==null?void 0:O.value)||J.merchant,amount:((Q=(Y=T.amount)==null?void 0:Y.value)==null?void 0:Q.toString())||J.amount,date:((X=T.date)==null?void 0:X.value)||J.date,cardUsed:K?`${K.name} (...${K.lastFour})`:J.cardUsed,zohoEntity:(K==null?void 0:K.entity)||J.zohoEntity,receiptUrl:F.receiptUrl||J.receiptUrl}})}catch(A){console.error("[ChecklistReceiptUpload] OCR failed:",A),alert("OCR processing failed. You can still enter expense details manually.")}finally{p(!1)}},j=async()=>{var g,v;if(!c||!S.merchant||!S.amount){alert("Please provide at least merchant and amount");return}p(!0);try{const A={event_id:r.id,category:ih[s],merchant:S.merchant,amount:parseFloat(S.amount),date:S.date,description:S.description,card_used:S.cardUsed,reimbursement_required:!1,zoho_entity:S.zohoEntity||void 0};S.receiptUrl&&(A.receipt_url=S.receiptUrl),console.log("[ChecklistReceiptUpload] Creating expense with receipt URL:",A),await se.createExpense(A),console.log("[ChecklistReceiptUpload] Expense created successfully with receipt"),alert("✅ Receipt saved successfully!"),i(),a()}catch(A){const F=A;console.error("[ChecklistReceiptUpload] Error creating expense:",F);const T=((v=(g=F.response)==null?void 0:g.data)==null?void 0:v.error)||F.message||"Failed to create expense. Please try again.";alert(`❌ Failed to save receipt:
./dist/assets/index-C-FEraip.js:503:${T}`)}finally{p(!1)}};return t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(Ct,{className:"w-6 h-6 text-blue-600"}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upload Receipt"}),t.jsxs("p",{className:"text-sm text-gray-500",children:[s.replace(/_/g," ").replace(/\b\w/g,g=>g.toUpperCase())," - ",r.name]})]})]}),t.jsx("button",{onClick:a,className:"p-1 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:t.jsx(Me,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"p-6 space-y-4",children:c?t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{className:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg",children:[t.jsx(Yg,{className:"w-5 h-5 text-blue-600"}),t.jsx("span",{className:"text-sm text-gray-700 flex-1",children:c.name}),t.jsx("button",{onClick:()=>{m(null),y(null)},className:"text-red-500 hover:text-red-700",children:t.jsx(Me,{className:"w-4 h-4"})})]}),d&&t.jsxs("div",{className:"flex items-center gap-2 text-blue-600",children:[t.jsx(ao,{className:"w-5 h-5 animate-pulse"}),t.jsx("span",{className:"text-sm",children:"Processing receipt with OCR..."})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Merchant *"}),t.jsx("input",{type:"text",value:S.merchant,onChange:g=>E({...S,merchant:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"e.g., Expo Services, Airline, Hotel Name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),t.jsxs("div",{className:"relative",children:[t.jsx(kt,{className:"absolute left-3 top-2.5 w-4 h-4 text-gray-400"}),t.jsx("input",{type:"number",step:"0.01",value:S.amount,onChange:g=>E({...S,amount:g.target.value}),className:"w-full pl-9 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",placeholder:"0.00"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),t.jsx("input",{type:"date",value:S.date,onChange:g=>E({...S,date:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Used"}),t.jsxs("select",{value:S.cardUsed,onChange:g=>{const v=g.target.value,A=f.find(F=>`${F.name} (...${F.lastFour})`===v);E({...S,cardUsed:v,zohoEntity:(A==null?void 0:A.entity)||""})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[t.jsx("option",{value:"",children:"Select card..."}),f.map((g,v)=>t.jsxs("option",{value:`${g.name} (...${g.lastFour})`,children:[g.name," (...",g.lastFour,")"]},v))]})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),t.jsx("textarea",{value:S.description,onChange:g=>E({...S,description:g.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 resize-none",rows:2,placeholder:`Expense for ${s.replace(/_/g," ")}`})]})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:t.jsxs("p",{className:"text-sm text-blue-900",children:[t.jsx("strong",{children:"Category:"})," ",ih[s],t.jsx("br",{}),t.jsx("span",{className:"text-xs text-blue-700",children:"Auto-assigned based on checklist section"})]})}),t.jsxs("div",{className:"flex gap-3 justify-end pt-4 border-t",children:[t.jsx("button",{onClick:a,className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",disabled:d,children:"Cancel"}),t.jsx("button",{onClick:j,disabled:d||!S.merchant||!S.amount,className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",children:d?"Creating...":"Create Expense"})]})]}):t.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[t.jsx(is,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-600 mb-2",children:"Drop receipt here or click to upload"}),t.jsx("input",{ref:_,type:"file",accept:"image/*",onChange:g=>g.target.files&&w(g.target.files[0]),className:"hidden"}),t.jsx("button",{onClick:()=>{var g;return(g=_.current)==null?void 0:g.click()},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",children:"Choose File"})]})})]})})},Gy=({receipts:e,isOpen:r,onClose:s})=>{const[n,a]=C.useState(0),i=C.useRef(e.length),c=C.useCallback(()=>{a(S=>S===0?e.length-1:S-1)},[e.length]),m=C.useCallback(()=>{a(S=>S===e.length-1?0:S+1)},[e.length]);if(C.useEffect(()=>{i.current=e.length},[e.length]),C.useEffect(()=>{r&&e.length>0&&a(0)},[r,e.length]),C.useEffect(()=>{if(!r)return;const S=E=>{E.key==="ArrowLeft"?a(_=>{const w=i.current;return w>0?_===0?w-1:_-1:0}):E.key==="ArrowRight"?a(_=>{const w=i.current;return w>0?_===w-1?0:_+1:0}):E.key==="Escape"&&s()};return window.addEventListener("keydown",S),()=>window.removeEventListener("keydown",S)},[r,s]),!r||e.length===0)return null;const d=Math.max(0,Math.min(n,e.length-1)),p=e[d],y=p.receiptUrl?`https://expapp.duckdns.org/api${p.receiptUrl.startsWith("/")?"":"/"}${p.receiptUrl}`:"",f=S=>{a(S)},k=({icon:S,label:E,value:_,bgColor:w,iconColor:j})=>t.jsxs("div",{className:"flex items-start space-x-3",children:[t.jsx("div",{className:`w-10 h-10 ${w} rounded-lg flex items-center justify-center flex-shrink-0`,children:t.jsx("div",{className:j,children:S})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500",children:E}),t.jsx("p",{className:"font-semibold text-gray-900 text-lg",children:_})]})]});return t.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-90 z-50 flex items-center justify-center p-4 overflow-y-auto",onClick:s,children:[t.jsx("button",{onClick:s,className:"fixed top-4 right-4 p-2 bg-white rounded-full hover:bg-gray-100 transition-colors z-10",title:"Close (Esc)",children:t.jsx(Me,{className:"w-6 h-6 text-gray-900"})}),t.jsxs("div",{className:"max-w-7xl w-full my-8 bg-white rounded-xl shadow-2xl overflow-hidden",onClick:S=>S.stopPropagation(),children:[t.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 px-6 py-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:"Expense Details"}),t.jsxs("div",{className:"text-white text-sm font-medium",children:["Receipt ",n+1," of ",e.length]})]})}),t.jsxs("div",{className:"p-6 space-y-6 max-h-[calc(90vh-120px)] overflow-y-auto",children:[t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Expense Information"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsx(k,{icon:t.jsx(Mt,{className:"w-5 h-5"}),label:"Date",value:xt(p.date),bgColor:"bg-blue-100",iconColor:"text-blue-600"}),t.jsx(k,{icon:t.jsx(kt,{className:"w-5 h-5"}),label:"Amount",value:`$${p.amount.toFixed(2)}`,bgColor:"bg-emerald-100",iconColor:"text-emerald-600"}),t.jsx(k,{icon:t.jsx(Yt,{className:"w-5 h-5"}),label:"Category",value:p.category,bgColor:"bg-purple-100",iconColor:"text-purple-600"}),t.jsx(k,{icon:t.jsx(Ct,{className:"w-5 h-5"}),label:"Merchant",value:p.merchant,bgColor:"bg-orange-100",iconColor:"text-orange-600"}),t.jsx(k,{icon:t.jsx(na,{className:"w-5 h-5"}),label:"Card Used",value:p.cardUsed||"N/A",bgColor:"bg-indigo-100",iconColor:"text-indigo-600"}),p.location&&t.jsx(k,{icon:t.jsx(Ls,{className:"w-5 h-5"}),label:"Location",value:p.location,bgColor:"bg-red-100",iconColor:"text-red-600"})]}),p.description&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[t.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Description"}),t.jsx("p",{className:"text-gray-900",children:p.description})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Status"}),t.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${uu(p.status)}`,children:p.status==="needs further review"?"Needs Further Review":p.status.charAt(0).toUpperCase()+p.status.slice(1)})]}),p.reimbursementRequired&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Reimbursement"}),t.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${lo(p.reimbursementStatus||"pending review")}`,children:zi(p.reimbursementStatus||"pending review")})]}),p.zohoEntity&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Entity"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(Ds,{className:"w-4 h-4 text-gray-600"}),t.jsx("span",{className:"text-gray-900 font-medium",children:p.zohoEntity})]})]}),p.zohoExpenseId&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Zoho Status"}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx(ut,{className:"w-4 h-4 text-green-600"}),t.jsx("span",{className:"text-gray-900 font-medium",children:"Synced to Zoho"})]})]})]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900 border-b border-gray-200 pb-2",children:"Receipt Image"}),t.jsxs("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden min-h-[400px] flex items-center justify-center",children:[e.length>1&&t.jsx("button",{onClick:c,className:"absolute left-4 p-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full transition-all z-10",title:"Previous (←)",children:t.jsx(Px,{className:"w-8 h-8 text-white"})}),t.jsx("div",{className:"flex-1 flex items-center justify-center p-4",children:y?t.jsx("img",{src:y,alt:`Receipt ${n+1}`,className:"max-w-full max-h-[600px] w-auto h-auto rounded-lg shadow-2xl object-contain"}):t.jsx("div",{className:"text-white text-center",children:t.jsx("p",{className:"text-lg",children:"No receipt image available"})})}),e.length>1&&t.jsx("button",{onClick:m,className:"absolute right-4 p-3 bg-white bg-opacity-20 hover:bg-opacity-30 rounded-full transition-all z-10",title:"Next (→)",children:t.jsx(Wg,{className:"w-8 h-8 text-white"})})]}),e.length>1&&t.jsx("div",{className:"flex justify-center gap-2 overflow-x-auto pb-2",children:e.map((S,E)=>{const w=S.receiptUrl?`https://expapp.duckdns.org/api${S.receiptUrl.startsWith("/")?"":"/"}${S.receiptUrl}`:"";return t.jsx("button",{onClick:()=>f(E),className:`flex-shrink-0 w-20 h-20 rounded-lg overflow-hidden border-2 transition-all ${E===n?"border-purple-600 scale-110":"border-gray-300 opacity-60 hover:opacity-100"}`,title:`View receipt ${E+1}`,children:w?t.jsx("img",{src:w,alt:`Thumbnail ${E+1}`,className:"w-full h-full object-cover"}):t.jsx("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:t.jsx("span",{className:"text-gray-600 text-xs",children:E+1})})},S.id)})})]})]})]})]})},Yy=({boothMapUrl:e,uploadingMap:r,boothMapInputRef:s,onMapUpload:n,onDeleteMap:a})=>{const[i,c]=C.useState(!1);return t.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 bg-gray-50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("label",{className:"text-xs font-medium text-gray-700 flex items-center gap-1",children:[t.jsx(Mx,{className:"w-4 h-4"}),"Booth Floor Plan"]}),e&&t.jsx("button",{onClick:a,className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete map",children:t.jsx(Me,{className:"w-4 h-4"})})]}),e?t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"relative group",children:t.jsx("img",{src:`https://expapp.duckdns.org/api${e}`,alt:"Booth Map",className:"w-full h-32 object-contain bg-white rounded border border-gray-200 cursor-pointer hover:opacity-90 transition-opacity",onClick:()=>c(!0),title:"Click to view full size"})}),t.jsx("div",{className:"flex gap-2",children:t.jsxs("button",{onClick:()=>{var m;return(m=s.current)==null?void 0:m.click()},className:"flex-1 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm flex items-center justify-center gap-1 transition-colors",children:[t.jsx(is,{className:"w-4 h-4"}),"Replace"]})})]}):t.jsx("button",{onClick:()=>{var m;return(m=s.current)==null?void 0:m.click()},disabled:r,className:"w-full py-2 px-3 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-400 hover:bg-purple-50 transition-colors text-sm text-gray-600 flex items-center justify-center gap-2 disabled:opacity-50",children:r?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-purple-600"}),"Uploading..."]}):t.jsxs(t.Fragment,{children:[t.jsx(is,{className:"w-4 h-4"}),"Upload Floor Plan"]})}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload booth layout/map (JPG, PNG, GIF, PDF • Max 10MB)"}),e&&t.jsx(Bx,{boothMapUrl:e,isOpen:i,onClose:()=>c(!1)})]})},Zy=({checklist:e,boothNotes:r,setBoothNotes:s,onBoothToggle:n,onNotesBlur:a,onMapUpload:i,onDeleteMap:c,uploadingMap:m,saving:d,receiptCount:p,onViewReceipt:N,onUploadReceipt:y,boothMapInputRef:f})=>t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[t.jsxs("button",{onClick:n,disabled:d,className:"flex items-start gap-3 w-full text-left group",children:[e.booth_ordered?t.jsx(ct,{className:"w-6 h-6 text-green-600 flex-shrink-0 group-hover:scale-110 transition-transform"}):t.jsx(wr,{className:"w-6 h-6 text-gray-400 flex-shrink-0 group-hover:text-gray-600 transition-colors"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:`font-medium ${e.booth_ordered?"text-gray-900":"text-gray-700"}`,children:"Booth Space Ordered"}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Reserve exhibition space at the venue"})]})]}),t.jsxs("div",{className:"mt-3 ml-9 space-y-2",children:[t.jsx("textarea",{value:r,onChange:k=>s(k.target.value),onBlur:a,placeholder:"Add notes (booth number, size, location, etc.)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm resize-none",rows:2}),t.jsx(Yy,{boothMapUrl:e.booth_map_url,uploadingMap:m,boothMapInputRef:f,onMapUpload:i,onDeleteMap:c}),t.jsxs("div",{className:"flex items-center gap-2",children:[p>0&&t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-lg text-xs font-medium",children:[t.jsx(ct,{className:"w-3 h-3"}),p," Receipt",p!==1?"s":""]}),t.jsxs("button",{onClick:N,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",title:"View receipt",children:[t.jsx(Gt,{className:"w-4 h-4"}),"View"]})]}),t.jsxs("button",{onClick:y,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-purple-600 hover:text-purple-700 hover:bg-purple-50 rounded-lg transition-colors",children:[t.jsx(Ct,{className:"w-4 h-4"}),p>0?"Add Another":"Upload Receipt"]})]})]})]}),Xy=({checklist:e,electricityNotes:r,setElectricityNotes:s,onElectricityToggle:n,onNotesBlur:a,saving:i,receiptCount:c,onViewReceipt:m,onUploadReceipt:d})=>t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[t.jsxs("button",{onClick:n,disabled:i,className:"flex items-start gap-3 w-full text-left group",children:[e.electricity_ordered?t.jsx(ct,{className:"w-6 h-6 text-green-600 flex-shrink-0 group-hover:scale-110 transition-transform"}):t.jsx(wr,{className:"w-6 h-6 text-gray-400 flex-shrink-0 group-hover:text-gray-600 transition-colors"}),t.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[t.jsx(du,{className:"w-5 h-5 text-yellow-600"}),t.jsxs("div",{children:[t.jsx("p",{className:`font-medium ${e.electricity_ordered?"text-gray-900":"text-gray-700"}`,children:"Electricity Ordered"}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Order power/electrical hookups for the booth"})]})]})]}),t.jsxs("div",{className:"mt-3 ml-9 space-y-2",children:[t.jsx("textarea",{value:r,onChange:p=>s(p.target.value),onBlur:a,placeholder:"Add notes (voltage, number of outlets, special requirements, etc.)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-500 focus:border-transparent text-sm resize-none",rows:2}),t.jsxs("div",{className:"flex items-center gap-2",children:[c>0&&t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-lg text-xs font-medium",children:[t.jsx(ct,{className:"w-3 h-3"}),c," Receipt",c!==1?"s":""]}),t.jsxs("button",{onClick:m,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",title:"View receipt",children:[t.jsx(Gt,{className:"w-4 h-4"}),"View"]})]}),t.jsxs("button",{onClick:d,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-purple-600 hover:text-purple-700 hover:bg-purple-50 rounded-lg transition-colors",children:[t.jsx(Ct,{className:"w-4 h-4"}),c>0?"Add Another":"Upload Receipt"]})]})]})]}),Jy=({checklist:e,showAddShipmentForm:r,setShowAddShipmentForm:s,newShipmentData:n,handleNewShipmentFieldChange:a,savingShipment:i,onAddShipment:c,onDeleteShipment:m,onToggleShipped:d,receiptCount:p,onViewReceipt:N,onUploadReceipt:y})=>t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors bg-gray-50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(rh,{className:"w-5 h-5 text-purple-600"}),t.jsx("h4",{className:"font-medium text-gray-900",children:"Booth Shipping"}),e.boothShipping.length>0&&t.jsxs("span",{className:"px-2 py-1 bg-purple-100 text-purple-700 rounded-lg text-xs font-medium",children:[e.boothShipping.length," Shipment",e.boothShipping.length!==1?"s":""]})]}),t.jsxs("button",{onClick:()=>s(!r),className:"flex items-center gap-1 px-3 py-1.5 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors text-sm",children:[t.jsx(rh,{className:"w-4 h-4"}),r?"Cancel":"Add Shipment"]})]}),t.jsxs("div",{className:"space-y-3",children:[e.boothShipping.map(f=>t.jsx("div",{className:"border border-gray-200 rounded-lg p-3 bg-white",children:t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsx("button",{onClick:()=>d(f),className:"flex-shrink-0 mt-0.5",children:f.shipped?t.jsx(ct,{className:"w-5 h-5 text-green-600 hover:scale-110 transition-transform"}):t.jsx(wr,{className:"w-5 h-5 text-gray-400 hover:text-gray-600 transition-colors"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[t.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${f.shipping_method==="carrier"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:f.shipping_method==="carrier"?"Carrier":"Manual"}),f.shipped&&t.jsx("span",{className:"inline-flex items-center px-2 py-0.5 bg-green-100 text-green-700 rounded text-xs font-medium",children:"Shipped"})]}),f.shipping_method==="carrier"&&t.jsxs("div",{className:"space-y-1 text-sm",children:[f.carrier_name&&t.jsxs("p",{className:"text-gray-700",children:[t.jsx("span",{className:"font-medium",children:"Carrier:"})," ",f.carrier_name]}),f.tracking_number&&t.jsxs("p",{className:"text-gray-700",children:[t.jsx("span",{className:"font-medium",children:"Tracking:"})," ",f.tracking_number]})]}),t.jsxs("div",{className:"flex gap-4 text-xs text-gray-600 mt-2",children:[f.shipping_date&&t.jsxs("span",{children:["Shipped: ",new Date(f.shipping_date).toLocaleDateString()]}),f.delivery_date&&t.jsxs("span",{children:["Delivery: ",new Date(f.delivery_date).toLocaleDateString()]})]}),f.notes&&t.jsx("p",{className:"text-xs text-gray-600 mt-2 italic",children:f.notes})]}),t.jsx("button",{onClick:()=>m(f.id),className:"flex-shrink-0 p-1.5 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete shipment",children:t.jsx(Me,{className:"w-4 h-4"})})]})},f.id)),r&&t.jsxs("div",{className:"border border-purple-300 rounded-lg p-4 bg-purple-50",children:[t.jsx("h5",{className:"font-medium text-gray-900 mb-3 text-sm",children:"New Shipment"}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Shipping Method"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",value:"carrier",checked:n.shipping_method==="carrier",onChange:f=>a("shipping_method",f.target.value),className:"w-4 h-4 text-purple-600 focus:ring-purple-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Carrier Shipping"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",value:"manual",checked:n.shipping_method==="manual",onChange:f=>a("shipping_method",f.target.value),className:"w-4 h-4 text-purple-600 focus:ring-purple-500"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Manual Delivery"})]})]})]}),n.shipping_method==="carrier"&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Carrier Name"}),t.jsx("input",{type:"text",value:n.carrier_name||"",onChange:f=>a("carrier_name",f.target.value),placeholder:"e.g., FedEx, UPS, Road Runner",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Tracking Number"}),t.jsx("input",{type:"text",value:n.tracking_number||"",onChange:f=>a("tracking_number",f.target.value),placeholder:"Tracking/shipment number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Shipping Date"}),t.jsx("input",{type:"date",value:n.shipping_date||"",onChange:f=>a("shipping_date",f.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Expected Delivery"}),t.jsx("input",{type:"date",value:n.delivery_date||"",onChange:f=>a("delivery_date",f.target.value),min:n.shipping_date||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm"})]})]}),t.jsxs("div",{className:"mb-3",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),t.jsx("textarea",{value:n.notes||"",onChange:f=>a("notes",f.target.value),placeholder:"Shipment details, special instructions, contact info, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent text-sm resize-none",rows:2})]}),t.jsxs("div",{className:"mb-3 flex items-center gap-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[t.jsx("button",{type:"button",onClick:()=>a("shipped",!n.shipped),className:"flex-shrink-0",children:n.shipped?t.jsx(ct,{className:"w-6 h-6 text-green-600 hover:scale-110 transition-transform"}):t.jsx(wr,{className:"w-6 h-6 text-gray-400 hover:text-gray-600 transition-colors"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-gray-900 text-sm",children:"Mark as Shipped"}),t.jsx("p",{className:"text-xs text-gray-600",children:"Check this if the booth materials have already been shipped"})]})]}),t.jsx("button",{onClick:c,disabled:i,className:"w-full py-2 px-4 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium disabled:opacity-50",children:i?"Adding...":"Add Shipment"})]}),e.boothShipping.length===0&&!r&&t.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:'No shipments added yet. Click "Add Shipment" to get started.'}),t.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[p>0&&t.jsxs(t.Fragment,{children:[t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-green-100 text-green-700 rounded-lg text-xs font-medium",children:[t.jsx(ct,{className:"w-3 h-3"}),p," Receipt",p!==1?"s":""]}),t.jsxs("button",{onClick:N,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",title:"View receipt",children:[t.jsx(Gt,{className:"w-4 h-4"}),"View"]})]}),t.jsxs("button",{onClick:y,className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-purple-600 hover:text-purple-700 hover:bg-purple-50 rounded-lg transition-colors",children:[t.jsx(Ct,{className:"w-4 h-4"}),p>0?"Add Another":"Upload Receipt"]})]})]})]});function ev(e){const[r,s]=C.useState({booth:[],electricity:[],booth_shipping:[]}),[n,a]=C.useState(!0),i=C.useCallback(async()=>{try{a(!0),console.log("[useBoothReceipts] Loading receipts for event:",e.id);const c=await se.getExpenses({event_id:e.id});console.log("[useBoothReceipts] Loaded expenses:",c.length);const m=c.filter(p=>p.category==="Booth / Marketing / Tools"),d={booth:m.filter(p=>{var N;return!((N=p.description)!=null&&N.toLowerCase().includes("electricity"))}),electricity:m.filter(p=>{var N;return(N=p.description)==null?void 0:N.toLowerCase().includes("electricity")}),booth_shipping:c.filter(p=>p.category==="Shipping Charges")};console.log("[useBoothReceipts] Categorized receipts:",{booth:d.booth.length,electricity:d.electricity.length,booth_shipping:d.booth_shipping.length}),s(d)}catch(c){console.error("[useBoothReceipts] Error loading receipts:",c)}finally{a(!1)}},[e.id]);return C.useEffect(()=>{i()},[i]),{receiptStatus:r,loadingReceipts:n,loadReceipts:i}}const tv=({checklist:e,user:r,event:s,onUpdate:n,onReload:a,saving:i})=>{const[c,m]=C.useState(e.booth_notes||""),[d,p]=C.useState(e.electricity_notes||""),[N,y]=C.useState(null),[f,k]=C.useState(!1),S=C.useRef(null),[E,_]=C.useState([]),[w,j]=C.useState(!1),[g,v]=C.useState(!1),[A,F]=C.useState({shipping_method:"carrier",carrier_name:null,tracking_number:null,shipping_date:null,delivery_date:null,notes:null,shipped:!1}),[T,R]=C.useState(!1),{receiptStatus:K,loadReceipts:J}=ev(s),O=async()=>{y(null),await a(),await J(),console.log("[BoothSection] Receipt created and data refreshed")},Y=async()=>{await n({booth_ordered:!e.booth_ordered})},Q=async()=>{await n({electricity_ordered:!e.electricity_ordered})},X=async()=>{c!==e.booth_notes&&await n({booth_notes:c})},fe=async()=>{d!==e.electricity_notes&&await n({electricity_notes:d})},Ce=async ae=>{var Le;const me=(Le=ae.target.files)==null?void 0:Le[0];if(!me)return;if(!["image/jpeg","image/jpg","image/png","image/gif","application/pdf"].includes(me.type)){alert("Please upload an image file (JPEG, PNG, GIF) or PDF");return}if(me.size>10*1024*1024){alert("File size must be less than 10MB");return}k(!0);try{await se.checklist.uploadBoothMap(e.id,me),a()}catch(ye){console.error("[BoothSection] Error uploading booth map:",ye),alert("Failed to upload booth map")}finally{k(!1),S.current&&(S.current.value="")}},Pe=async()=>{if(confirm("Are you sure you want to delete the booth map?"))try{await se.checklist.deleteBoothMap(e.id),a()}catch(ae){console.error("[BoothSection] Error deleting booth map:",ae),alert("Failed to delete booth map")}},re=(ae,me)=>{F({...A,[ae]:me})},ie=async()=>{R(!0);try{const ae={shippingMethod:A.shipping_method,carrierName:A.carrier_name,trackingNumber:A.tracking_number,shippingDate:A.shipping_date,deliveryDate:A.delivery_date,notes:A.notes,shipped:A.shipped};await se.checklist.createBoothShipping(e.id,ae),F({shipping_method:"carrier",carrier_name:null,tracking_number:null,shipping_date:null,delivery_date:null,notes:null,shipped:!1}),v(!1),a()}catch(ae){console.error("[BoothSection] Error adding shipment:",ae),alert("Failed to add booth shipment")}finally{R(!1)}},te=async ae=>{if(confirm("Are you sure you want to delete this shipment?"))try{const me=typeof ae=="string"?parseInt(ae,10):ae;if(isNaN(me)){console.error("[BoothSection] Invalid shipment ID:",ae);return}await se.checklist.deleteBoothShipping(me),a()}catch(me){console.error("[BoothSection] Error deleting shipment:",me),alert("Failed to delete shipment")}},ce=async ae=>{if(ae.id)try{await se.checklist.updateBoothShipping(ae.id,{shippingMethod:ae.shipping_method,carrierName:ae.carrier_name,trackingNumber:ae.tracking_number,shippingDate:ae.shipping_date,deliveryDate:ae.delivery_date,notes:ae.notes,shipped:!ae.shipped}),a()}catch(me){console.error("[BoothSection] Error toggling shipped:",me)}};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"p-4 sm:p-6 space-y-4",children:[t.jsx(Zy,{checklist:e,boothNotes:c,setBoothNotes:m,onBoothToggle:Y,onNotesBlur:X,onMapUpload:Ce,onDeleteMap:Pe,uploadingMap:f,saving:i,receiptCount:K.booth.length,onViewReceipt:()=>{const ae=K.booth.filter(me=>me.receiptUrl);ae.length>0&&(_(ae),j(!0))},onUploadReceipt:()=>y("booth"),boothMapInputRef:S}),t.jsx("input",{ref:S,type:"file",accept:"image/*,.pdf",onChange:Ce,className:"hidden"}),t.jsx(Xy,{checklist:e,electricityNotes:d,setElectricityNotes:p,onElectricityToggle:Q,onNotesBlur:fe,saving:i,receiptCount:K.electricity.length,onViewReceipt:()=>{const ae=K.electricity.filter(me=>me.receiptUrl);ae.length>0&&(_(ae),j(!0))},onUploadReceipt:()=>y("electricity")}),t.jsx(Jy,{checklist:e,showAddShipmentForm:g,setShowAddShipmentForm:v,newShipmentData:A,handleNewShipmentFieldChange:re,savingShipment:T,onAddShipment:ie,onDeleteShipment:te,onToggleShipped:ce,receiptCount:K.booth_shipping.length,onViewReceipt:()=>{const ae=K.booth_shipping.filter(me=>me.receiptUrl);ae.length>0&&(_(ae),j(!0))},onUploadReceipt:()=>y("booth_shipping")})]}),N&&t.jsx(io,{user:r,event:s,section:N,onClose:()=>y(null),onExpenseCreated:O}),t.jsx(Gy,{receipts:E,isOpen:w,onClose:()=>{j(!1),_([])}})]})},rv=({checklist:e,user:r,event:s,onReload:n})=>{const[a,i]=C.useState({}),[c,m]=C.useState({}),[d,p]=C.useState(null),N=s.participants||[],y=E=>e.flights.find(_=>{var w;return((w=_.attendee_id)==null?void 0:w.toString())===E}),f=(E,_,w)=>{var g;const j=y(E)||{attendee_id:E,attendee_name:((g=N.find(v=>v.id===E))==null?void 0:g.name)||"",carrier:null,confirmation_number:null,notes:null,booked:!1};i({...a,[E]:{...j,...a[E],[_]:w}})},k=async E=>{const _=a[E];if(_){m({...c,[E]:!0});try{const w=y(E),j=!w||!w.id,g={attendeeId:_.attendee_id,attendeeName:_.attendee_name,carrier:_.carrier,confirmationNumber:_.confirmation_number,notes:_.notes,booked:!0};w&&w.id?await se.checklist.updateFlight(w.id,g):await se.checklist.createFlight(e.id,g);const v={...a};delete v[E],i(v),n()}catch(w){console.error("[FlightsSection] Error saving flight:",w),alert("Failed to save flight information")}finally{m({...c,[E]:!1})}}},S=async E=>{const _=y(E);if(!(!_||!_.id))try{await se.checklist.updateFlight(_.id,{carrier:_.carrier,confirmationNumber:_.confirmation_number,notes:_.notes,booked:!_.booked}),n()}catch(w){console.error("[FlightsSection] Error toggling flight:",w)}};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"p-4 sm:p-6",children:N.length===0?t.jsx("p",{className:"text-gray-500 text-sm",children:"No participants added to this event yet."}):t.jsx("div",{className:"space-y-3",children:N.sort((E,_)=>{const w=y(E.id),j=y(_.id);return(w==null?void 0:w.booked)===(j==null?void 0:j.booked)?0:w!=null&&w.booked?1:-1}).map(E=>{const _=y(E.id),w=a[E.id],j=w||_,g=!!w;return t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>(_==null?void 0:_.id)&&S(E.id),disabled:!(_!=null&&_.id),className:"disabled:opacity-50 disabled:cursor-not-allowed",children:_!=null&&_.booked?t.jsx(ct,{className:"w-6 h-6 text-green-600 hover:scale-110 transition-transform"}):t.jsx(wr,{className:"w-6 h-6 text-gray-400 hover:text-gray-600 transition-colors"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:E.name}),t.jsx("p",{className:"text-xs text-gray-500",children:E.email})]})]}),g&&t.jsxs("button",{onClick:()=>k(E.id),disabled:c[E.id],className:"flex items-center gap-1 px-3 py-1.5 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm disabled:opacity-50",children:[t.jsx(ea,{className:"w-4 h-4"}),"Save"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 ml-9",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Carrier"}),t.jsx("input",{type:"text",value:(j==null?void 0:j.carrier)||"",onChange:v=>f(E.id,"carrier",v.target.value),placeholder:"e.g., Delta, United",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Confirmation Number"}),t.jsx("input",{type:"text",value:(j==null?void 0:j.confirmation_number)||"",onChange:v=>f(E.id,"confirmation_number",v.target.value),placeholder:"Booking reference",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),t.jsx("textarea",{value:(j==null?void 0:j.notes)||"",onChange:v=>f(E.id,"notes",v.target.value),placeholder:"Flight times, layovers, seat preferences, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm resize-none",rows:2})]}),t.jsx("div",{className:"md:col-span-2",children:t.jsxs("button",{onClick:()=>p({attendeeId:E.id,attendeeName:E.name}),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",children:[t.jsx(Ct,{className:"w-4 h-4"}),"Upload Receipt"]})})]})]},E.id)})})}),d&&t.jsx(io,{user:r,event:s,section:"flight",attendeeName:d.attendeeName,onClose:()=>p(null),onExpenseCreated:()=>{p(null),n()}})]})},sv=({checklist:e,user:r,event:s,onReload:n})=>{const[a,i]=C.useState({}),[c,m]=C.useState({}),[d,p]=C.useState(null),N=s.participants||[],y=E=>e.hotels.find(_=>{var w;return((w=_.attendee_id)==null?void 0:w.toString())===E}),f=(E,_,w)=>{var g;const j=y(E)||{attendee_id:E,attendee_name:((g=N.find(v=>v.id===E))==null?void 0:g.name)||"",property_name:null,confirmation_number:null,check_in_date:null,check_out_date:null,notes:null,booked:!1};i({...a,[E]:{...j,...a[E],[_]:w}})},k=async E=>{const _=a[E];if(_){m({...c,[E]:!0});try{const w=y(E),j=!w||!w.id,g={attendeeId:_.attendee_id,attendeeName:_.attendee_name,propertyName:_.property_name,confirmationNumber:_.confirmation_number,checkInDate:_.check_in_date,checkOutDate:_.check_out_date,notes:_.notes,booked:!0};w&&w.id?await se.checklist.updateHotel(w.id,g):await se.checklist.createHotel(e.id,g);const v={...a};delete v[E],i(v),n()}catch(w){console.error("[HotelsSection] Error saving hotel:",w),alert("Failed to save hotel information")}finally{m({...c,[E]:!1})}}},S=async E=>{const _=y(E);if(!(!_||!_.id))try{await se.checklist.updateHotel(_.id,{propertyName:_.property_name,confirmationNumber:_.confirmation_number,checkInDate:_.check_in_date,checkOutDate:_.check_out_date,notes:_.notes,booked:!_.booked}),n()}catch(w){console.error("[HotelsSection] Error toggling hotel:",w)}};return t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"p-4 sm:p-6",children:N.length===0?t.jsx("p",{className:"text-gray-500 text-sm",children:"No participants added to this event yet."}):t.jsx("div",{className:"space-y-3",children:N.sort((E,_)=>{const w=y(E.id),j=y(_.id);return(w==null?void 0:w.booked)===(j==null?void 0:j.booked)?0:w!=null&&w.booked?1:-1}).map(E=>{const _=y(E.id),w=a[E.id],j=w||_,g=!!w;return t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>(_==null?void 0:_.id)&&S(E.id),disabled:!(_!=null&&_.id),className:"disabled:opacity-50 disabled:cursor-not-allowed",children:_!=null&&_.booked?t.jsx(ct,{className:"w-6 h-6 text-green-600 hover:scale-110 transition-transform"}):t.jsx(wr,{className:"w-6 h-6 text-gray-400 hover:text-gray-600 transition-colors"})}),t.jsxs("div",{children:[t.jsx("p",{className:"font-medium text-gray-900",children:E.name}),t.jsx("p",{className:"text-xs text-gray-500",children:E.email})]})]}),g&&t.jsxs("button",{onClick:()=>k(E.id),disabled:c[E.id],className:"flex items-center gap-1 px-3 py-1.5 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-sm disabled:opacity-50",children:[t.jsx(ea,{className:"w-4 h-4"}),"Save"]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 ml-9",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Property Name"}),t.jsx("input",{type:"text",value:(j==null?void 0:j.property_name)||"",onChange:v=>f(E.id,"property_name",v.target.value),placeholder:"e.g., Marriott Downtown",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Confirmation Number"}),t.jsx("input",{type:"text",value:(j==null?void 0:j.confirmation_number)||"",onChange:v=>f(E.id,"confirmation_number",v.target.value),placeholder:"Reservation number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Check-In Date"}),t.jsx("input",{type:"date",value:(j==null?void 0:j.check_in_date)||"",onChange:v=>f(E.id,"check_in_date",v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Check-Out Date"}),t.jsx("input",{type:"date",value:(j==null?void 0:j.check_out_date)||"",onChange:v=>f(E.id,"check_out_date",v.target.value),min:(j==null?void 0:j.check_in_date)||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),t.jsx("textarea",{value:(j==null?void 0:j.notes)||"",onChange:v=>f(E.id,"notes",v.target.value),placeholder:"Room type, special requests, loyalty numbers, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-emerald-500 focus:border-transparent text-sm resize-none",rows:2})]}),t.jsx("div",{className:"md:col-span-2",children:t.jsxs("button",{onClick:()=>p({attendeeId:E.id,attendeeName:E.name}),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-emerald-600 hover:text-emerald-700 hover:bg-emerald-50 rounded-lg transition-colors",children:[t.jsx(Ct,{className:"w-4 h-4"}),"Upload Receipt"]})})]})]},E.id)})})}),d&&t.jsx(io,{user:r,event:s,section:"hotel",attendeeName:d.attendeeName,onClose:()=>p(null),onExpenseCreated:()=>{p(null),n()}})]})},nv=({checklist:e,user:r,event:s,onReload:n})=>{const[a,i]=C.useState({}),[c,m]=C.useState({}),[d,p]=C.useState(!1),[N,y]=C.useState(null),[f,k]=C.useState({provider:null,confirmation_number:null,pickup_date:null,return_date:null,notes:null,booked:!1,rental_type:"group",assigned_to_id:null,assigned_to_name:null}),[S,E]=C.useState(null),[_,w]=C.useState(!1),j=(T,R,K)=>{const J=e.carRentals.find(O=>O.id===T);J&&i({...a,[T]:{...J,...a[T],[R]:K}})},g=async T=>{const R=a[T];if(R){m({...c,[T]:!0});try{await se.checklist.updateCarRental(T,{provider:R.provider,confirmationNumber:R.confirmation_number,pickupDate:R.pickup_date,returnDate:R.return_date,notes:R.notes,booked:!0,rentalType:R.rental_type||"group",assignedToId:R.assigned_to_id||null,assignedToName:R.assigned_to_name||null});const K={...a};delete K[T],i(K),n()}catch(K){console.error("[CarRentalsSection] Error saving rental:",K),alert("Failed to save car rental information")}finally{m({...c,[T]:!1})}}},v=async()=>{m({...c,[-1]:!0});try{if(await se.checklist.createCarRental(e.id,{provider:f.provider,confirmationNumber:f.confirmation_number,pickupDate:f.pickup_date,returnDate:f.return_date,notes:f.notes,booked:!0,rentalType:f.rental_type||"group",assignedToId:f.assigned_to_id||null,assignedToName:f.assigned_to_name||null}),S)try{const T={event_id:s.id,category:"Rental - Car / U-haul",merchant:f.provider||"Car Rental",amount:0,date:f.pickup_date||new Date().toISOString().split("T")[0],description:`Car rental - ${f.provider||"Unnamed"}`,card_used:"",reimbursement_required:!1};await se.createExpense(T,S),console.log("[CarRentalsSection] Receipt uploaded and expense created")}catch(T){console.error("[CarRentalsSection] Failed to upload receipt:",T),alert("Car rental saved, but receipt upload failed. You can upload it later.")}k({provider:null,confirmation_number:null,pickup_date:null,return_date:null,notes:null,booked:!1,rental_type:"group",assigned_to_id:null,assigned_to_name:null}),E(null),p(!1),n()}catch(T){console.error("[CarRentalsSection] Error adding rental:",T),alert("Failed to add car rental")}finally{m({...c,[-1]:!1})}},A=async T=>{if(confirm("Delete this car rental?"))try{await se.checklist.deleteCarRental(T),n()}catch(R){console.error("[CarRentalsSection] Error deleting rental:",R),alert("Failed to delete car rental")}},F=async T=>{const R=e.carRentals.find(K=>K.id===T);if(R)try{await se.checklist.updateCarRental(T,{provider:R.provider,confirmationNumber:R.confirmation_number,pickupDate:R.pickup_date,returnDate:R.return_date,notes:R.notes,booked:!R.booked,rentalType:R.rental_type||"group",assignedToId:R.assigned_to_id||null,assignedToName:R.assigned_to_name||null}),n()}catch(K){console.error("[CarRentalsSection] Error toggling rental:",K)}};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"p-4 sm:p-6",children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsxs("button",{onClick:()=>p(!d),className:"flex items-center gap-1 px-3 py-1.5 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm",children:[t.jsx(Lr,{className:"w-4 h-4"}),"Add Rental"]})}),d&&t.jsxs("div",{className:"border border-orange-200 rounded-lg p-4 mb-3 bg-orange-50",children:[t.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"New Car Rental"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Rental Type"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"newRentalType",value:"group",checked:f.rental_type==="group",onChange:T=>k({...f,rental_type:"group",assigned_to_id:null,assigned_to_name:null}),className:"text-orange-500 focus:ring-orange-500"}),t.jsx(Nr,{className:"w-4 h-4 text-orange-600"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Group Rental (Shared)"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:"newRentalType",value:"individual",checked:f.rental_type==="individual",onChange:T=>k({...f,rental_type:"individual"}),className:"text-orange-500 focus:ring-orange-500"}),t.jsx(rs,{className:"w-4 h-4 text-orange-600"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Individual Rental"})]})]})]}),f.rental_type==="individual"&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Assign to Participant"}),t.jsxs("select",{value:f.assigned_to_id||"",onChange:T=>{const R=T.target.value,K=s.participants.find(J=>J.id===R);k({...f,assigned_to_id:R||null,assigned_to_name:(K==null?void 0:K.name)||null})},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",children:[t.jsx("option",{value:"",children:"Select participant..."}),s.participants.map(T=>t.jsx("option",{value:T.id,children:T.name},T.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Provider"}),t.jsx("input",{type:"text",value:f.provider||"",onChange:T=>k({...f,provider:T.target.value}),placeholder:"e.g., Enterprise, Hertz",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Confirmation Number"}),t.jsx("input",{type:"text",value:f.confirmation_number||"",onChange:T=>k({...f,confirmation_number:T.target.value}),placeholder:"Reservation number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pickup Date"}),t.jsx("input",{type:"date",value:f.pickup_date||"",onChange:T=>k({...f,pickup_date:T.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Return Date"}),t.jsx("input",{type:"date",value:f.return_date||"",onChange:T=>k({...f,return_date:T.target.value}),min:f.pickup_date||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),t.jsx("textarea",{value:f.notes||"",onChange:T=>k({...f,notes:T.target.value}),placeholder:"Vehicle type, pickup/return locations, insurance, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm resize-none",rows:2})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Receipt (Optional)"}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("label",{className:"flex-1 cursor-pointer",children:[t.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 border-2 border-dashed border-gray-300 rounded-lg hover:border-orange-400 hover:bg-orange-50 transition-colors",children:[t.jsx(Ct,{className:"w-4 h-4 text-orange-600"}),t.jsx("span",{className:"text-sm text-gray-700",children:S?S.name:"Upload receipt (optional)"})]}),t.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:T=>{var K;const R=(K=T.target.files)==null?void 0:K[0];R&&E(R)},className:"hidden"})]}),S&&t.jsx("button",{onClick:()=>E(null),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Remove receipt",children:t.jsx(Me,{className:"w-4 h-4"})})]}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Upload the rental receipt now to save time"})]})]}),t.jsxs("div",{className:"flex gap-2 mt-3",children:[t.jsx("button",{onClick:v,disabled:c[-1],className:"px-4 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:c[-1]?"Saving...":"Add"}),t.jsx("button",{onClick:()=>{p(!1),E(null)},disabled:c[-1],className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-sm font-medium disabled:opacity-50",children:"Cancel"})]})]}),e.carRentals.length===0?t.jsx("p",{className:"text-gray-500 text-sm",children:"No car rentals added yet."}):t.jsx("div",{className:"space-y-3",children:e.carRentals.sort((T,R)=>T.booked===R.booked?0:T.booked?1:-1).map(T=>{const R=a[T.id],K=R||T,J=!!R;return t.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("button",{onClick:()=>F(T.id),className:"disabled:opacity-50 disabled:cursor-not-allowed",children:T.booked?t.jsx(ct,{className:"w-6 h-6 text-green-600 hover:scale-110 transition-transform"}):t.jsx(wr,{className:"w-6 h-6 text-gray-400 hover:text-gray-600 transition-colors"})}),t.jsx("div",{children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("p",{className:"font-medium text-gray-900",children:K.provider||"Unnamed Rental"}),K.rental_type==="individual"&&K.assigned_to_name&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-orange-100 text-orange-700 rounded-full text-xs font-medium",children:[t.jsx(rs,{className:"w-3 h-3"}),K.assigned_to_name]}),K.rental_type==="group"&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:[t.jsx(Nr,{className:"w-3 h-3"}),"Group"]})]})})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[J&&t.jsxs("button",{onClick:()=>g(T.id),disabled:c[T.id],className:"flex items-center gap-1 px-3 py-1.5 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition-colors text-sm disabled:opacity-50",children:[t.jsx(ea,{className:"w-4 h-4"}),"Save"]}),t.jsx("button",{onClick:()=>A(T.id),className:"p-1.5 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:t.jsx(Ur,{className:"w-4 h-4"})})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 ml-9",children:[t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Rental Type"}),t.jsxs("div",{className:"flex gap-4",children:[t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:`rentalType-${T.id}`,value:"group",checked:K.rental_type==="group",onChange:O=>{j(T.id,"rental_type","group"),j(T.id,"assigned_to_id",null),j(T.id,"assigned_to_name",null)},className:"text-orange-500 focus:ring-orange-500"}),t.jsx(Nr,{className:"w-4 h-4 text-orange-600"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Group Rental (Shared)"})]}),t.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[t.jsx("input",{type:"radio",name:`rentalType-${T.id}`,value:"individual",checked:K.rental_type==="individual",onChange:O=>j(T.id,"rental_type","individual"),className:"text-orange-500 focus:ring-orange-500"}),t.jsx(rs,{className:"w-4 h-4 text-orange-600"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Individual Rental"})]})]})]}),K.rental_type==="individual"&&t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Assigned to Participant"}),t.jsxs("select",{value:K.assigned_to_id||"",onChange:O=>{const Y=O.target.value,Q=s.participants.find(X=>X.id===Y);j(T.id,"assigned_to_id",Y||null),j(T.id,"assigned_to_name",(Q==null?void 0:Q.name)||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm",children:[t.jsx("option",{value:"",children:"Select participant..."}),s.participants.map(O=>t.jsx("option",{value:O.id,children:O.name},O.id))]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Provider"}),t.jsx("input",{type:"text",value:K.provider||"",onChange:O=>j(T.id,"provider",O.target.value),placeholder:"e.g., Enterprise, Hertz",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Confirmation Number"}),t.jsx("input",{type:"text",value:K.confirmation_number||"",onChange:O=>j(T.id,"confirmation_number",O.target.value),placeholder:"Reservation number",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Pickup Date"}),t.jsx("input",{type:"date",value:K.pickup_date||"",onChange:O=>j(T.id,"pickup_date",O.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Return Date"}),t.jsx("input",{type:"date",value:K.return_date||"",onChange:O=>j(T.id,"return_date",O.target.value),min:K.pickup_date||"",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm"})]}),t.jsxs("div",{className:"md:col-span-2",children:[t.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Notes"}),t.jsx("textarea",{value:K.notes||"",onChange:O=>j(T.id,"notes",O.target.value),placeholder:"Vehicle type, pickup/return locations, insurance, etc.",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent text-sm resize-none",rows:2})]}),t.jsx("div",{className:"md:col-span-2",children:t.jsxs("button",{onClick:()=>y(T.id),className:"flex items-center gap-1.5 px-3 py-1.5 text-sm text-orange-600 hover:text-orange-700 hover:bg-orange-50 rounded-lg transition-colors",children:[t.jsx(Ct,{className:"w-4 h-4"}),"Upload Receipt"]})})]})]},T.id)})})]}),N&&t.jsx(io,{user:r,event:s,section:"car_rental",onClose:()=>y(null),onExpenseCreated:()=>{y(null),n()}})]})},av=({checklist:e,onReload:r,canEdit:s,isAdmin:n})=>{const[a,i]=C.useState(!1),[c,m]=C.useState(null),[d,p]=C.useState({title:"",description:""}),[N,y]=C.useState({title:"",description:""}),[f,k]=C.useState(!1),[S,E]=C.useState(!1),[_,w]=C.useState([]),[j,g]=C.useState(!1),v=async()=>{if(!d.title.trim()){alert("Title is required");return}k(!0);try{await se.checklist.createCustomItem(e.id,{title:d.title,description:d.description||null,position:e.customItems.length}),p({title:"",description:""}),i(!1),r()}catch(Q){console.error("[CustomItemsSection] Error adding item:",Q),alert("Failed to add custom item")}finally{k(!1)}},A=Q=>{m(Q.id||null),y({title:Q.title,description:Q.description||""})},F=async Q=>{if(!N.title.trim()){alert("Title is required");return}k(!0);try{await se.checklist.updateCustomItem(Q,{title:N.title,description:N.description||null}),m(null),r()}catch(X){console.error("[CustomItemsSection] Error updating item:",X),alert("Failed to update custom item")}finally{k(!1)}},T=()=>{m(null),y({title:"",description:""})},R=async Q=>{try{await se.checklist.updateCustomItem(Q.id,{completed:!Q.completed}),r()}catch(X){console.error("[CustomItemsSection] Error toggling item:",X),alert("Failed to update item status")}},K=async Q=>{if(confirm("Delete this custom item?"))try{await se.checklist.deleteCustomItem(Q),r()}catch(X){console.error("[CustomItemsSection] Error deleting item:",X),alert("Failed to delete custom item")}},J=async()=>{if(confirm("This will add all standard tasks to this event. Continue?")){k(!0);try{await se.checklist.applyTemplates(e.id),r(),alert("Standard tasks applied successfully!")}catch(Q){console.error("[CustomItemsSection] Error applying templates:",Q),alert("Failed to apply standard tasks")}finally{k(!1)}}},O=async()=>{g(!0);try{const Q=await se.checklist.getTemplates();w(Q)}catch(Q){console.error("[CustomItemsSection] Error loading templates:",Q)}finally{g(!1)}},Y=()=>{E(!0),O()};return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"p-4 sm:p-6",children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:s&&!a&&t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("button",{onClick:J,disabled:f,className:"flex items-center gap-1 px-3 py-1.5 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors text-sm disabled:opacity-50",title:"Add standard tasks to this event",children:[t.jsx(Is,{className:"w-4 h-4"}),"Apply Standard Tasks"]}),n&&t.jsxs("button",{onClick:Y,className:"flex items-center gap-1 px-3 py-1.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",title:"Manage standard tasks for all events",children:[t.jsx(cu,{className:"w-4 h-4"}),"Manage Templates"]}),t.jsxs("button",{onClick:()=>i(!0),className:"flex items-center gap-1 px-3 py-1.5 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors text-sm",children:[t.jsx(Lr,{className:"w-4 h-4"}),"Add Task"]})]})}),a&&t.jsx("div",{className:"mb-4 border border-indigo-200 rounded-lg p-4 bg-indigo-50",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Task Title *"}),t.jsx("input",{type:"text",value:d.title,onChange:Q=>p({...d,title:Q.target.value}),placeholder:"e.g., Order promotional materials",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm",autoFocus:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),t.jsx("textarea",{value:d.description,onChange:Q=>p({...d,description:Q.target.value}),placeholder:"Additional details about this task...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm resize-none",rows:2})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:v,disabled:f||!d.title.trim(),className:"flex items-center gap-1 px-3 py-2 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors text-sm disabled:opacity-50",children:[t.jsx(ea,{className:"w-4 h-4"}),"Add Task"]}),t.jsx("button",{onClick:()=>{i(!1),p({title:"",description:""})},className:"px-3 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:"Cancel"})]})]})}),e.customItems.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx(ty,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-sm",children:"No custom tasks yet"}),s&&t.jsx("p",{className:"text-xs text-gray-400 mt-1",children:'Click "Add Task" to create event-specific checklist items'})]}):t.jsx("div",{className:"space-y-3",children:e.customItems.sort((Q,X)=>Q.completed===X.completed?0:Q.completed?1:-1).map(Q=>t.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:c===Q.id?t.jsxs("div",{className:"space-y-3",children:[t.jsx("div",{children:t.jsx("input",{type:"text",value:N.title,onChange:X=>y({...N,title:X.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm font-medium"})}),t.jsx("div",{children:t.jsx("textarea",{value:N.description,onChange:X=>y({...N,description:X.target.value}),placeholder:"Description (optional)",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent text-sm resize-none",rows:2})}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("button",{onClick:()=>F(Q.id),disabled:f||!N.title.trim(),className:"flex items-center gap-1 px-3 py-1.5 bg-indigo-500 text-white rounded-lg hover:bg-indigo-600 transition-colors text-sm disabled:opacity-50",children:[t.jsx(ea,{className:"w-4 h-4"}),"Save"]}),t.jsxs("button",{onClick:T,className:"flex items-center gap-1 px-3 py-1.5 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors text-sm",children:[t.jsx(Me,{className:"w-4 h-4"}),"Cancel"]})]})]}):t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("button",{onClick:()=>R(Q),className:"mt-0.5 flex-shrink-0",children:Q.completed?t.jsx(ct,{className:"w-6 h-6 text-green-600 hover:scale-110 transition-transform"}):t.jsx(wr,{className:"w-6 h-6 text-gray-400 hover:text-gray-600 transition-colors"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:`font-medium ${Q.completed?"text-gray-500 line-through":"text-gray-900"}`,children:Q.title}),Q.description&&t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Q.description})]}),s&&t.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[t.jsx("button",{onClick:()=>A(Q),className:"p-1.5 text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 rounded transition-colors",title:"Edit",children:t.jsx(iu,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>K(Q.id),className:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete",children:t.jsx(Ur,{className:"w-4 h-4"})})]})]})},Q.id))})]}),S&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:t.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto",children:[t.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex items-center justify-between",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Manage Standard Tasks"}),t.jsx("button",{onClick:()=>E(!1),className:"p-1 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:t.jsx(Me,{className:"w-5 h-5"})})]}),t.jsxs("div",{className:"p-6",children:[t.jsx("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:t.jsxs("p",{className:"text-sm text-blue-900",children:[t.jsx("strong",{children:"Standard Tasks"})," are automatically added to every new event's checklist. Manage them here to ensure consistency across all trade shows."]})}),j?t.jsx("div",{className:"text-center py-8 text-gray-500",children:"Loading templates..."}):_.length===0?t.jsxs("div",{className:"text-center py-8 text-gray-500",children:[t.jsx("p",{children:"No standard tasks yet."}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Tasks you create here will auto-apply to all new events."})]}):t.jsx("div",{className:"space-y-3",children:_.map((Q,X)=>t.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsxs("span",{className:"text-gray-400 font-mono text-sm mt-1",children:[X+1,"."]}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium text-gray-900",children:Q.title}),Q.description&&t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Q.description})]})]})},Q.id))}),t.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:t.jsxs("p",{className:"text-xs text-gray-500",children:["💡 ",t.jsx("strong",{children:"Tip:"})," To add/edit/delete standard tasks, you'll need to update them in the database or add CRUD UI here in a future update."]})})]})]})})]})},ka=({title:e,icon:r,isComplete:s,itemCount:n,completedCount:a,children:i,defaultCollapsed:c=!1})=>{const[m,d]=C.useState(c),p=()=>{d(!m)};return t.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[t.jsxs("button",{onClick:p,className:"w-full flex items-center justify-between p-4 sm:p-6 hover:bg-gray-50 transition-colors group",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:`flex-shrink-0 ${s?"text-green-600":"text-purple-600"}`,children:r}),t.jsxs("div",{className:"text-left",children:[t.jsxs("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e,s&&t.jsx("span",{className:"px-2 py-0.5 bg-green-100 text-green-700 rounded text-xs font-medium",children:"✓"})]}),n!==void 0&&t.jsxs("p",{className:"text-xs sm:text-sm text-gray-600 mt-0.5",children:[a,"/",n," completed"]})]})]}),t.jsx("div",{className:"flex-shrink-0 ml-2",children:m?t.jsx(_x,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600 transition-colors"}):t.jsx(Tx,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600 transition-colors"})})]}),!m&&t.jsx("div",{className:"border-t border-gray-100",children:i})]})};function oh(e,r){switch(e){case"booth":return!0;case"flights":return r.flights.length>0;case"hotels":return r.hotels.length>0;case"car_rentals":return r.carRentals.length>0;case"custom":return r.customItems.length>0;default:return!0}}const ch=({user:e})=>t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"My Checklist"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Personal preparation checklist for trade shows"})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-lg flex items-center justify-center",children:t.jsx(Yt,{className:"w-6 h-6 text-white"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Trade Show Guidelines Document"}),t.jsxs("span",{className:"px-2.5 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded-full flex items-center gap-1",children:[t.jsx(hr,{className:"w-3 h-3"}),"Coming Soon"]})]}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Access comprehensive guidelines and best practices for trade show participation."})]})]})}),t.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:t.jsxs("div",{className:"flex items-start gap-4",children:[t.jsx("div",{className:"flex-shrink-0",children:t.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:t.jsx(ny,{className:"w-6 h-6 text-white"})})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Packing List"}),t.jsxs("span",{className:"px-2.5 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded-full flex items-center gap-1",children:[t.jsx(hr,{className:"w-3 h-3"}),"Coming Soon"]})]}),t.jsx("p",{className:"text-gray-600 text-sm",children:"Get a personalized packing checklist based on your event and travel details."})]})]})})]}),t.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:t.jsxs("p",{className:"text-sm text-blue-800",children:[t.jsx("strong",{children:"Note:"})," These features are currently under development. Check back soon for updates!"]})})]}),lv=({user:e})=>{const r=e.role==="admin"||e.role==="coordinator"||e.role==="developer",[s,n]=C.useState(r?"admin":"user"),[a,i]=C.useState([]),[c,m]=C.useState(null),[d,p]=C.useState(null),[N,y]=C.useState(!1),[f,k]=C.useState(!1);C.useEffect(()=>{s==="admin"&&S()},[s]),C.useEffect(()=>{c&&E(c)},[c]);const S=async()=>{try{if(se.USE_SERVER){console.log("[Checklist] Fetching events...");const g=await se.getEvents();if(console.log("[Checklist] API response:",g),!g){console.error("[Checklist] API returned null/undefined"),i([]);return}const v=Array.isArray(g)?g:[];console.log("[Checklist] Loaded events:",v.length,"events"),i(v),v.length>0&&!c&&(console.log("[Checklist] Auto-selecting first event:",v[0].id),m(v[0].id))}}catch(g){console.error("[Checklist] Error loading events:",g),i([])}},E=async g=>{y(!0);try{if(se.USE_SERVER){console.log("[Checklist] Loading checklist for event:",g);const v=await se.checklist.getChecklist(g);if(console.log("[Checklist] Checklist loaded:",v),!v||typeof v!="object"){console.warn("[Checklist] No data received from API or invalid data type"),p(null);return}const A=v,F={id:typeof A.id=="number"?A.id:0,event_id:typeof A.event_id=="number"?A.event_id:0,booth_ordered:typeof A.booth_ordered=="boolean"?A.booth_ordered:!1,booth_notes:typeof A.booth_notes=="string"?A.booth_notes:null,booth_map_url:typeof A.booth_map_url=="string"?A.booth_map_url:null,electricity_ordered:typeof A.electricity_ordered=="boolean"?A.electricity_ordered:!1,electricity_notes:typeof A.electricity_notes=="string"?A.electricity_notes:null,flights:Array.isArray(A.flights)?A.flights:[],hotels:Array.isArray(A.hotels)?A.hotels:[],carRentals:Array.isArray(A.carRentals)?A.carRentals:[],boothShipping:Array.isArray(A.boothShipping)?A.boothShipping:[],customItems:Array.isArray(A.customItems)?A.customItems:[]};console.log("[Checklist] Normalized checklist data:",F),p(F)}}catch(v){console.error("[Checklist] Error loading checklist:",v),p(null)}finally{y(!1)}},_=async g=>{if(d){k(!0);try{se.USE_SERVER&&(await se.checklist.updateChecklist(d.id,{boothOrdered:g.booth_ordered??d.booth_ordered,boothNotes:g.booth_notes??d.booth_notes,electricityOrdered:g.electricity_ordered??d.electricity_ordered,electricityNotes:g.electricity_notes??d.electricity_notes}),p({...d,...g}))}catch(v){console.error("[Checklist] Error updating checklist:",v),alert("Failed to save changes")}finally{k(!1)}}},w=a.find(g=>g.id===c),j=()=>{if(!d)return 0;let g=0,v=0;return v+=1,d.booth_ordered&&(g+=1),v+=1,d.electricity_ordered&&(g+=1),v+=d.flights.length,g+=d.flights.filter(A=>A.booked).length,v+=d.hotels.length,g+=d.hotels.filter(A=>A.booked).length,v+=d.carRentals.length,g+=d.carRentals.filter(A=>A.booked).length,v+=1,d.boothShipping.length>0&&d.boothShipping[0].shipped&&(g+=1),v>0?Math.round(g/v*100):0};return r?t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Checklist"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Manage logistics and preparations for trade shows"}),t.jsx("div",{className:"mt-4 border-b border-gray-200",children:t.jsxs("nav",{className:"-mb-px flex space-x-8",children:[t.jsx("button",{onClick:()=>n("admin"),className:`
./dist/assets/index-C-FEraip.js:543:This indicates the reimbursement has been processed and paid to the user.`:""))){m.target.value=e.reimbursementStatus||"pending review";return}await a(d)},className:"px-3 py-1.5 text-sm font-medium rounded-lg border-2 border-gray-300 focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-all",children:[t.jsx("option",{value:"pending review",children:"Pending Review"}),t.jsx("option",{value:"approved",children:"Approved (pending payment)"}),t.jsx("option",{value:"rejected",children:"Rejected"}),(e.status==="approved"||e.reimbursementStatus==="paid")&&t.jsx("option",{value:"paid",children:"Paid"})]}):t.jsx("span",{className:`px-3 py-1 text-sm font-medium rounded-full ${lo(e.reimbursementStatus||"pending review")}`,children:zi(e.reimbursementStatus)})]}):t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Reimbursement"}),t.jsx("span",{className:"px-3 py-1 text-sm font-medium rounded-full bg-gray-100 text-gray-800",children:"Not Required"})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Entity"}),r?t.jsxs("select",{value:e.zohoEntity||"",onChange:async m=>{const d=m.target.value;e.zohoEntity&&e.zohoExpenseId&&d!==e.zohoEntity&&!window.confirm(`This expense was already pushed to Zoho under "${e.zohoEntity}". Changing the entity will clear the Zoho ID. Continue?`)||await i(d)},className:"px-3 py-1.5 text-sm font-medium rounded-lg border-2 border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 transition-all",children:[t.jsx("option",{value:"",children:"Unassigned"}),e.zohoEntity&&!s.includes(e.zohoEntity)&&t.jsx("option",{value:e.zohoEntity,children:e.zohoEntity}),s.map((m,d)=>t.jsx("option",{value:m,children:m},d))]}):e.zohoEntity?t.jsx("span",{className:"px-3 py-1 text-sm font-medium rounded-full bg-blue-100 text-blue-800",children:e.zohoEntity}):t.jsx("span",{className:"px-3 py-1 text-sm font-medium rounded-full bg-gray-100 text-gray-600",children:"Unassigned"})]}),r&&e.zohoEntity&&t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Zoho Status"}),e.zohoExpenseId?t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"px-3 py-1 text-sm font-medium rounded-full bg-emerald-100 text-emerald-800",children:"Pushed"}),t.jsxs("span",{className:"text-xs text-gray-500",children:["ID: ",e.zohoExpenseId]}),t.jsx(uh,{count:c,message:"after push - Zoho data may be stale"})]}):t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"px-3 py-1 text-sm font-medium rounded-full bg-yellow-100 text-yellow-800",children:"Not Pushed"}),t.jsx(uh,{count:c,message:"before push"})]})]})]})},Vv=({hasApprovalPermission:e,hasActiveFilters:r,pendingCount:s,onClearFilters:n,onShowPendingSync:a,onAddExpense:i})=>t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-0",children:[t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl md:text-2xl font-bold text-gray-900",children:"Expense Management"}),t.jsx("p",{className:"text-gray-600 mt-1",children:e?"Review, approve, and manage expense submissions":"Submit and track your trade show expenses"})]}),t.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 w-full sm:w-auto",children:[r&&t.jsxs("button",{onClick:n,className:"bg-gray-100 text-gray-700 px-4 py-3 rounded-lg font-medium hover:bg-gray-200 transition-all duration-200 flex items-center space-x-2",children:[t.jsx(Me,{className:"w-5 h-5"}),t.jsx("span",{children:"Clear Filters"})]}),s>0&&t.jsxs("button",{onClick:a,className:"relative bg-orange-50 text-orange-700 border border-orange-200 px-4 py-3 rounded-lg font-medium hover:bg-orange-100 transition-all duration-200 flex items-center space-x-2",children:[t.jsx(hr,{className:"w-5 h-5"}),t.jsx("span",{children:"Pending Sync"}),t.jsx("span",{className:"ml-1 px-2 py-0.5 bg-orange-500 text-white text-xs font-bold rounded-full",children:s})]}),t.jsxs("button",{onClick:i,className:"bg-gradient-to-r from-blue-500 to-emerald-500 text-white px-4 sm:px-5 md:px-6 py-2.5 sm:py-3 min-h-[44px] rounded-lg font-medium hover:from-blue-600 hover:to-emerald-600 transition-all duration-200 flex items-center space-x-2 shadow-lg shadow-blue-500/30",children:[t.jsx(Ct,{className:"w-5 h-5"}),t.jsx("span",{children:"Add Expense"})]})]})]}),Hv=({hasActiveFilters:e,onClearFilters:r,onAddExpense:s})=>t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-12 text-center",children:[t.jsx(Ct,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Expenses Found"}),t.jsx("p",{className:"text-gray-600 mb-6 max-w-md mx-auto",children:e?"Try adjusting your filters to see more expenses.":"Start by submitting your first expense with automatic OCR extraction from receipts."}),t.jsxs("div",{className:"flex justify-center space-x-4",children:[e&&t.jsx("button",{onClick:r,className:"bg-gray-100 text-gray-700 px-4 sm:px-5 md:px-6 py-2.5 sm:py-3 min-h-[44px] rounded-lg font-medium hover:bg-gray-200 transition-all duration-200",children:"Clear Filters"}),t.jsx("button",{onClick:s,className:"bg-gradient-to-r from-blue-500 to-emerald-500 text-white px-4 sm:px-5 md:px-6 py-2.5 sm:py-3 min-h-[44px] rounded-lg font-medium hover:from-blue-600 hover:to-emerald-600 transition-all duration-200",children:"Add Expense"})]})]}),Kv=({dateFilter:e,eventFilter:r,categoryFilter:s,merchantFilter:n,cardFilter:a,statusFilter:i,reimbursementFilter:c,sortBy:m,setDateFilter:d,setEventFilter:p,setCategoryFilter:N,setMerchantFilter:y,setCardFilter:f,setStatusFilter:k,setReimbursementFilter:S,setSortBy:E,expenses:_,events:w,uniqueCategories:j,uniqueCards:g,hasApprovalPermission:v})=>t.jsxs("tr",{className:"border-t border-gray-100",children:[t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1",children:t.jsxs("select",{value:e.substring(0,7)||"",onChange:A=>d(A.target.value),className:"w-full px-2 py-1 text-xs bg-white border border-gray-200 rounded text-gray-600 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all",children:[t.jsx("option",{value:"",children:"All"}),(()=>{const A=new Set,F=new Date,T=`${F.getFullYear()}-${String(F.getMonth()+1).padStart(2,"0")}`;return A.add(T),_.forEach(K=>{if(K.date){const J=K.date.substring(0,7);A.add(J)}}),Array.from(A).sort().reverse().map(K=>{const[J,O]=K.split("-"),Q=new Date(parseInt(J),parseInt(O)-1).toLocaleDateString("en-US",{year:"numeric",month:"short"});return t.jsx("option",{value:K,children:Q},K)})})()]})}),v&&t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1",children:t.jsxs("select",{value:r,onChange:A=>p(A.target.value),className:"w-full px-2 py-1 text-xs bg-white border border-gray-200 rounded text-gray-600 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all",children:[t.jsx("option",{value:"all",children:"All Events"}),w.map(A=>t.jsx("option",{value:A.id,children:A.name},A.id))]})}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1",children:t.jsxs("select",{value:s,onChange:A=>N(A.target.value),className:"w-full px-2 py-1 text-xs bg-white border border-gray-200 rounded text-gray-600 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all",children:[t.jsx("option",{value:"all",children:"All"}),j.map(A=>t.jsx("option",{value:A,children:A},A))]})}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1",children:t.jsx("input",{type:"text",value:n,onChange:A=>y(A.target.value),className:"w-full px-2 py-1 text-xs bg-white border border-gray-200 rounded text-gray-600 placeholder-gray-400 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all",placeholder:"Search..."})}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1",children:t.jsxs("select",{value:a,onChange:A=>f(A.target.value),className:"w-full px-2 py-1 text-xs bg-white border border-gray-200 rounded text-gray-600 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all",children:[t.jsx("option",{value:"all",children:"All"}),g.map(A=>t.jsx("option",{value:A,children:A},A))]})}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1",children:t.jsxs("select",{value:i,onChange:A=>k(A.target.value),className:"w-full px-2 py-1 text-xs bg-white border border-gray-200 rounded text-gray-600 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"pending",children:"Pending"}),t.jsx("option",{value:"approved",children:"Approved"}),t.jsx("option",{value:"rejected",children:"Rejected"})]})}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1",children:t.jsxs("select",{value:c,onChange:A=>S(A.target.value),className:"w-full px-2 py-1 text-xs bg-white border border-gray-200 rounded text-gray-600 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all",children:[t.jsx("option",{value:"all",children:"All"}),t.jsx("option",{value:"required",children:"Required"}),t.jsx("option",{value:"not-required",children:"Not Required"})]})}),v&&t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1"})]}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-1",children:t.jsxs("select",{value:m,onChange:A=>E(A.target.value),className:"w-full px-2 py-1 text-xs bg-white border border-gray-200 rounded text-gray-600 focus:outline-none focus:border-blue-400 focus:ring-1 focus:ring-blue-100 transition-all",children:[t.jsx("option",{value:"default",children:"Default"}),t.jsx("option",{value:"date-newest",children:"Newest First"}),t.jsx("option",{value:"date-oldest",children:"Oldest First"}),t.jsx("option",{value:"amount-highest",children:"Highest Amount"}),t.jsx("option",{value:"amount-lowest",children:"Lowest Amount"}),t.jsx("option",{value:"merchant-az",children:"Merchant A-Z"}),t.jsx("option",{value:"merchant-za",children:"Merchant Z-A"}),t.jsx("option",{value:"category-az",children:"Category A-Z"}),t.jsx("option",{value:"category-za",children:"Category Z-A"})]})})]}),Wv=({expense:e,event:r,userName:s,hasApprovalPermission:n,entityOptions:a,pushingExpenseId:i,pushedExpenses:c,onReimbursementApproval:m,onMarkAsPaid:d,onAssignEntity:p,onPushToZoho:N,onViewExpense:y,onDeleteExpense:f,currentUserId:k})=>t.jsxs("tr",{className:"hover:bg-gray-50",children:[t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5 text-xs sm:text-sm text-gray-900 whitespace-nowrap",children:xt(e.date)}),n&&t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5 text-xs sm:text-sm text-gray-700",children:s}),t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5 text-xs sm:text-sm text-gray-900",children:r?r.name:"No Event"}),t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5",children:t.jsx("span",{className:`px-1.5 py-0.5 text-[10px] sm:px-2 sm:py-1 sm:text-xs font-medium rounded-full whitespace-nowrap ${gy(e.category)}`,children:e.category})}),t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5",children:t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"text-xs sm:text-sm font-medium text-gray-900",children:e.merchant}),e.duplicateCheck&&e.duplicateCheck.length>0&&t.jsxs("div",{className:"relative group",children:[t.jsx("div",{className:"flex items-center text-amber-600 cursor-help",children:t.jsx(bt,{className:"w-4 h-4"})}),t.jsxs("div",{className:"absolute left-0 top-6 hidden group-hover:block z-50 w-80 p-3 bg-amber-50 border-2 border-amber-400 rounded-lg shadow-lg",children:[t.jsx("p",{className:"text-xs font-semibold text-amber-900 mb-2",children:"⚠ Possible Duplicate Expenses:"}),t.jsx("div",{className:"space-y-1",children:e.duplicateCheck.map((S,E)=>{const w=new Date(S.date).toLocaleDateString("en-US",{month:"short",day:"numeric"});return t.jsxs("div",{className:"text-xs text-amber-900",children:["$",S.amount.toFixed(2)," at ",S.merchant," on ",w]},E)})})]})]})]}),e.location&&t.jsx("div",{className:"text-xs sm:text-sm text-gray-500",children:e.location})]})}),t.jsxs("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5 text-xs sm:text-sm font-semibold text-gray-900 whitespace-nowrap",children:["$",e.amount.toFixed(2)]}),t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5 text-xs sm:text-sm text-gray-900",children:e.cardUsed}),t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5",children:t.jsx("span",{className:`px-1.5 py-0.5 text-[10px] sm:px-2 sm:py-1 sm:text-xs font-medium rounded-full whitespace-nowrap ${uu(e.status)}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})}),t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5",children:t.jsxs("div",{className:"space-y-1",children:[t.jsx("span",{className:`px-1.5 py-0.5 text-[10px] sm:px-2 sm:py-1 sm:text-xs font-medium rounded-full whitespace-nowrap ${e.reimbursementRequired?lo(e.reimbursementStatus||"pending review"):"bg-gray-100 text-gray-800"}`,children:e.reimbursementRequired?zi(e.reimbursementStatus):"Not Required"}),n&&e.reimbursementRequired&&t.jsxs(t.Fragment,{children:[(!e.reimbursementStatus||e.reimbursementStatus==="pending review")&&t.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[t.jsx("button",{onClick:()=>m(e,"approved"),className:"p-1 text-emerald-600 hover:bg-emerald-50 rounded transition-colors",title:"Approve Reimbursement",children:t.jsx(ut,{className:"w-3 h-3"})}),t.jsx("button",{onClick:()=>m(e,"rejected"),className:"p-1 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Reject Reimbursement",children:t.jsx(Me,{className:"w-3 h-3"})})]}),e.reimbursementStatus==="approved"&&t.jsx("div",{className:"flex items-center space-x-1 mt-1",children:t.jsx("button",{onClick:()=>d(e),className:"p-1 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Mark as Paid",children:t.jsx(kt,{className:"w-3 h-3"})})})]})]})}),n&&t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5",children:t.jsxs("select",{value:e.zohoEntity||"",onChange:S=>p(e,S.target.value),className:`text-xs border rounded px-2 py-1 focus:ring-2 focus:ring-blue-500 focus:border-transparent w-full min-w-[120px] ${e.zohoEntity?"border-gray-200 bg-gray-50 text-gray-500 cursor-not-allowed":"border-gray-300 bg-white text-gray-900"}`,disabled:!!e.zohoEntity,title:e.zohoEntity?"Entity assigned - use View Details to change":"",children:[t.jsx("option",{value:"",children:"Unassigned"}),e.zohoEntity&&!a.includes(e.zohoEntity)&&t.jsx("option",{value:e.zohoEntity,children:e.zohoEntity}),a.map((S,E)=>t.jsx("option",{value:S,children:S},E))]})}),n&&t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5",children:t.jsx("div",{className:"flex justify-center",children:e.zohoEntity?e.zohoExpenseId||c.has(e.id)?t.jsxs("div",{className:"flex items-center space-x-1 text-emerald-600",children:[t.jsx(ct,{className:"w-4 h-4"}),t.jsx("span",{className:"text-xs font-medium",children:"Pushed"})]}):i===e.id?t.jsxs("button",{disabled:!0,className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 rounded-md cursor-not-allowed",children:[t.jsx(Sr,{className:"w-3.5 h-3.5 animate-spin"}),t.jsx("span",{children:"Pushing..."})]}):t.jsxs("button",{onClick:()=>N(e),className:"flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 rounded-md transition-colors",title:`Push to ${e.zohoEntity} Zoho Books`,children:[t.jsx(is,{className:"w-3.5 h-3.5"}),t.jsx("span",{children:"Push"})]}):t.jsx("span",{className:"text-xs text-gray-400 italic",children:"No entity"})})}),t.jsx("td",{className:"px-2 sm:px-3 lg:px-4 py-2 sm:py-2.5 text-right",children:t.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[t.jsx("button",{onClick:()=>y(e),className:"p-2 text-gray-600 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-colors",title:"View Details & Receipt",children:t.jsx(Gt,{className:"w-4 h-4"})}),(e.userId===k||n)&&t.jsx("button",{onClick:()=>f(e.id),className:"p-2 text-gray-600 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:t.jsx(Ur,{className:"w-4 h-4"})})]})})]},e.id),Qv=({expenses:e,filteredExpenses:r,events:s,users:n,hasApprovalPermission:a,entityOptions:i,pushingExpenseId:c,pushedExpenses:m,showFilters:d,setShowFilters:p,dateFilter:N,setDateFilter:y,eventFilter:f,setEventFilter:k,categoryFilter:S,setCategoryFilter:E,merchantFilter:_,setMerchantFilter:w,cardFilter:j,setCardFilter:g,statusFilter:v,setStatusFilter:A,reimbursementFilter:F,setReimbursementFilter:T,sortBy:R,setSortBy:K,uniqueCategories:J,uniqueCards:O,onReimbursementApproval:Y,onMarkAsPaid:Q,onAssignEntity:X,onPushToZoho:fe,onViewExpense:Ce,onDeleteExpense:Pe,currentUserId:re})=>t.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full min-w-max",children:[t.jsxs("thead",{className:"bg-gray-50",children:[t.jsxs("tr",{children:[t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Date"}),a&&t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"User"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Event"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Category"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Merchant"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Amount"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Card Used"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Status"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Reimbursement"}),a&&t.jsxs(t.Fragment,{children:[t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-left text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Entity"}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-center text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:"Zoho"})]}),t.jsx("th",{className:"px-2 sm:px-3 lg:px-4 py-2.5 sm:py-3 min-h-[44px] text-right text-xs sm:text-sm font-medium text-gray-900 whitespace-nowrap",children:t.jsxs("div",{className:"flex items-center justify-end space-x-2",children:[t.jsx("span",{children:"Actions"}),t.jsx("button",{onClick:()=>p(!d),className:`p-1 rounded transition-colors ${d?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600 hover:bg-gray-100"}`,title:d?"Hide Filters":"Show Filters",children:t.jsx(Fi,{className:"w-3.5 h-3.5"})})]})})]}),t.jsx(Kv,{expenses:e,events:s,users:n,hasApprovalPermission:a,showFilters:d,dateFilter:N,setDateFilter:y,eventFilter:f,setEventFilter:k,categoryFilter:S,setCategoryFilter:E,merchantFilter:_,setMerchantFilter:w,cardFilter:j,setCardFilter:g,statusFilter:v,setStatusFilter:A,reimbursementFilter:F,setReimbursementFilter:T,sortBy:R,setSortBy:K,uniqueCategories:J,uniqueCards:O})]}),t.jsx("tbody",{className:"divide-y divide-gray-200",children:r.map(ie=>{var ae;const te=s.find(me=>me.id===ie.tradeShowId),ce=ie.user_name||((ae=n.find(me=>me.id===ie.userId))==null?void 0:ae.name)||"Unknown User";return t.jsx(Wv,{expense:ie,event:te,userName:ce,hasApprovalPermission:a,entityOptions:i,pushingExpenseId:c,pushedExpenses:m,onReimbursementApproval:Y,onMarkAsPaid:Q,onAssignEntity:X,onPushToZoho:fe,onViewExpense:Ce,onDeleteExpense:Pe,currentUserId:re},ie.id)})})]})})});class Gv{constructor(r="/api/health"){this.listeners=new Set,this.checkInterval=null,this.CHECK_INTERVAL=3e4,this.handleOnline=()=>{console.log("[NetworkMonitor] Browser online event"),this.checkConnectivity()},this.handleOffline=()=>{console.log("[NetworkMonitor] Browser offline event"),this.updateState({status:"offline",isOnline:!1,lastChecked:Date.now()})},this.handleConnectionChange=()=>{console.log("[NetworkMonitor] Connection change detected"),this.checkConnectivity()},this.handleVisibilityChange=()=>{document.hidden||(console.log("[NetworkMonitor] Page became visible, checking connectivity"),this.checkConnectivity())},this.HEALTH_CHECK_URL=r,this.state={status:navigator.onLine?"online":"offline",isOnline:navigator.onLine,lastChecked:Date.now()},this.init()}init(){if(console.log("[NetworkMonitor] Initializing..."),window.addEventListener("online",this.handleOnline),window.addEventListener("offline",this.handleOffline),"connection"in navigator){const r=navigator.connection;r==null||r.addEventListener("change",this.handleConnectionChange)}document.addEventListener("visibilitychange",this.handleVisibilityChange),this.startPeriodicChecks(),this.checkConnectivity()}cleanup(){if(console.log("[NetworkMonitor] Cleaning up..."),window.removeEventListener("online",this.handleOnline),window.removeEventListener("offline",this.handleOffline),document.removeEventListener("visibilitychange",this.handleVisibilityChange),"connection"in navigator){const r=navigator.connection;r==null||r.removeEventListener("change",this.handleConnectionChange)}this.checkInterval&&(clearInterval(this.checkInterval),this.checkInterval=null),this.listeners.clear()}startPeriodicChecks(){this.checkInterval&&clearInterval(this.checkInterval),this.checkInterval=setInterval(()=>{this.state.isOnline&&this.checkConnectivity()},this.CHECK_INTERVAL)}async checkConnectivity(){const r=Date.now();try{if(!navigator.onLine){this.updateState({status:"offline",isOnline:!1,lastChecked:Date.now()});return}const s=new AbortController,n=setTimeout(()=>s.abort(),1e4),a=await fetch(this.HEALTH_CHECK_URL,{method:"GET",cache:"no-cache",headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache"},signal:s.signal});clearTimeout(n);const i=Date.now()-r;if(a.ok){const c=this.getConnectionInfo(),m=i>3e3?"degraded":"online";this.updateState({status:m,isOnline:!0,rtt:i,...c,lastChecked:Date.now()}),console.log(`[NetworkMonitor] Connectivity check: ${m} (RTT: ${i}ms)`)}else console.warn("[NetworkMonitor] Backend returned error:",a.status,"- treating as degraded connection"),this.updateState({status:"online",isOnline:!0,rtt:i,lastChecked:Date.now()})}catch(s){!navigator.onLine?(console.error("[NetworkMonitor] Connectivity check failed - confirmed offline:",s.message),this.updateState({status:"offline",isOnline:!1,lastChecked:Date.now()})):(console.warn("[NetworkMonitor] Health check failed but browser reports online - likely backend/CORS issue:",s.message),this.updateState({status:"online",isOnline:!0,lastChecked:Date.now()}))}}getConnectionInfo(){if("connection"in navigator){const r=navigator.connection;return{effectiveType:r==null?void 0:r.effectiveType,downlink:r==null?void 0:r.downlink}}return{}}updateState(r){const s=this.state.status;this.state={...this.state,...r},s!==this.state.status&&(console.log(`[NetworkMonitor] Status changed: ${s} → ${this.state.status}`),this.notifyListeners())}notifyListeners(){this.listeners.forEach(r=>{try{r(this.state)}catch(s){console.error("[NetworkMonitor] Listener error:",s)}})}addListener(r,s=!1){return this.listeners.add(r),s&&r(this.state),()=>{this.listeners.delete(r)}}getState(){return{...this.state}}isOnline(){return this.state.isOnline}isOffline(){return!this.state.isOnline}isDegraded(){return this.state.status==="degraded"}async forceCheck(){return await this.checkConnectivity(),this.getState()}async waitForOnline(r=3e4){return this.isOnline()?!0:new Promise(s=>{const n=setTimeout(()=>{a(),s(!1)},r),a=this.addListener(i=>{i.isOnline&&(clearTimeout(n),a(),s(!0))})})}getStatusMessage(){switch(this.state.status){case"online":return"Connected";case"offline":return"No internet connection";case"degraded":return"Slow connection";default:return"Unknown"}}getConnectionQuality(){if(!this.state.isOnline)return 0;if(this.state.status==="degraded")return 50;if(this.state.rtt!==void 0)return this.state.rtt<50?100:this.state.rtt<200?90:this.state.rtt<500?75:this.state.rtt<1e3?60:50;switch(this.state.effectiveType){case"4g":return 100;case"3g":return 70;case"2g":return 40;case"slow-2g":return 20;default:return 80}}}const Ar=new Gv("https://expapp.duckdns.org/api/health");console.log("[NetworkMonitor] Initialized with status:",Ar.getState());class Yv{constructor(){this.isProcessing=!1,this.autoSyncEnabled=!0,this.listeners=new Set,this.MAX_RETRIES=5,this.MAX_BATCH_SIZE=20,this.init()}async init(){console.log("[SyncManager] Initializing..."),Ar.addListener(s=>{s.isOnline&&this.autoSyncEnabled&&!this.isProcessing&&(console.log("[SyncManager] Network came online, starting auto-sync..."),this.processQueue())});const r=await Ye.getQueueStats();r.pending>0&&(console.log(`[SyncManager] Found ${r.pending} pending items in queue`),Ar.isOnline()&&this.processQueue()),console.log("[SyncManager] Initialized successfully")}async queueAction(r,s,n,a){const i=this.getCurrentUserId(),c=await Ye.getDeviceId(),m=rl(),d=await Ye.addToQueue({action:r,entity:s,data:n,localId:a,userId:i,deviceId:c,idempotencyKey:m});return console.log(`[SyncManager] Queued ${r} ${s}:`,d),this.notifyListeners("queue-updated",{queueId:d,action:r,entity:s}),Ar.isOnline()&&this.autoSyncEnabled&&this.processQueue(),d}async processQueue(){if(this.isProcessing)return console.log("[SyncManager] Sync already in progress, skipping..."),{success:!1,synced:0,failed:0,errors:[]};if(!Ar.isOnline())return console.log("[SyncManager] Offline, cannot sync"),{success:!1,synced:0,failed:0,errors:[]};this.isProcessing=!0,this.notifyListeners("sync-start"),console.log("[SyncManager] Processing sync queue...");try{const r=await Ye.getPendingQueueItems();if(r.length===0)return console.log("[SyncManager] No pending items to sync"),this.isProcessing=!1,{success:!0,synced:0,failed:0,errors:[]};console.log(`[SyncManager] Found ${r.length} pending items`);const s={success:!0,synced:0,failed:0,errors:[]};for(let n=0;n<r.length;n+=this.MAX_BATCH_SIZE){const a=r.slice(n,n+this.MAX_BATCH_SIZE);console.log(`[SyncManager] Processing batch ${n/this.MAX_BATCH_SIZE+1}/${Math.ceil(r.length/this.MAX_BATCH_SIZE)}`);for(const i of a)try{await this.syncItem(i),s.synced++}catch(c){console.error(`[SyncManager] Failed to sync item ${i.id}:`,c),s.failed++,s.errors.push({item:i,error:c.message})}}return await Ye.clearSuccessfulQueueItems(),await Ye.setLastSyncTime(Date.now()),console.log(`[SyncManager] Sync complete: ${s.synced} synced, ${s.failed} failed`),this.notifyListeners("sync-complete",s),s}catch(r){return console.error("[SyncManager] Sync queue processing error:",r),this.notifyListeners("sync-error",{error:r.message}),{success:!1,synced:0,failed:0,errors:[{item:{},error:r.message}]}}finally{this.isProcessing=!1}}async syncItem(r){if(r.retryCount>=this.MAX_RETRIES){console.warn(`[SyncManager] Item ${r.id} exceeded max retries, marking as failed`),await Ye.markQueueItemFailed(r.id,`Max retries (${this.MAX_RETRIES}) exceeded`,r.retryCount);return}await Ye.updateQueueItem(r.id,{status:"syncing",lastAttempt:Date.now()});try{let s;switch(r.entity){case"expense":s=await this.syncExpense(r);break;case"event":s=await this.syncEvent(r);break;case"user":s=await this.syncUser(r);break;default:throw new Error(`Unknown entity type: ${r.entity}`)}await Ye.markQueueItemSynced(r.id,s),r.entity==="expense"&&s&&await this.updateLocalIdMapping(r.localId,s),console.log(`[SyncManager] Successfully synced ${r.entity} ${r.action}`)}catch(s){console.error(`[SyncManager] Error syncing item ${r.id}:`,s);const n=r.retryCount+1,a=Math.pow(2,n)*1e3;throw console.log(`[SyncManager] Will retry in ${a}ms (attempt ${n}/${this.MAX_RETRIES})`),await Ye.markQueueItemFailed(r.id,s.message,n),n<this.MAX_RETRIES&&setTimeout(async()=>{await Ye.updateQueueItem(r.id,{status:"pending"})},a),s}}async syncExpense(r){switch(r.action){case"CREATE":return(await(void 0)(r.data,r.data.receipt)).id;case"UPDATE":return await(void 0)(r.remoteId||r.data.id,r.data,r.data.receipt),r.remoteId||r.data.id;case"DELETE":throw new Error("Delete not implemented yet");case"APPROVE":return await(void 0)(r.data.id,r.data.status,r.data.comments),r.data.id;default:throw new Error(`Unknown expense action: ${r.action}`)}}async syncEvent(r){switch(r.action){case"CREATE":return(await(void 0)(r.data)).id;case"UPDATE":return await(void 0)(r.remoteId||r.data.id,r.data),r.remoteId||r.data.id;default:throw new Error(`Unknown event action: ${r.action}`)}}async syncUser(r){switch(r.action){case"CREATE":return(await(void 0)(r.data)).id;case"UPDATE":throw new Error("User update not implemented yet");default:throw new Error(`Unknown user action: ${r.action}`)}}async updateLocalIdMapping(r,s){if(!r)return;console.log(`[SyncManager] Mapping local ID ${r} → remote ID ${s}`);const n=await Ye.getCachedExpense(r);n&&(n.id=s,n.syncStatus="synced",await Ye.cacheExpense(n.data),await Ye.deleteCachedExpense(r))}async getStatus(){const r=await Ye.getQueueStats(),s=await Ye.getLastSyncTime();return{isSync:Ar.isOnline(),pendingCount:r.pending,failedCount:r.failed,lastSyncTime:s,currentlyProcessing:this.isProcessing}}async retryFailed(){const r=await Ye.getFailedQueueItems();console.log(`[SyncManager] Retrying ${r.length} failed items`);for(const s of r)await Ye.updateQueueItem(s.id,{status:"pending",retryCount:0,error:void 0});return await this.processQueue()}async clearFailedItem(r){console.log(`[SyncManager] Clearing failed item: ${r}`),await Ye.deleteQueueItem(r),this.notifyListeners("queue-updated")}setAutoSync(r){console.log(`[SyncManager] Auto-sync ${r?"enabled":"disabled"}`),this.autoSyncEnabled=r}addEventListener(r){return this.listeners.add(r),()=>this.listeners.delete(r)}notifyListeners(r,s){this.listeners.forEach(n=>{try{n({type:r,data:s})}catch(a){console.error("[SyncManager] Listener error:",a)}})}getCurrentUserId(){const r=localStorage.getItem("currentUser");if(r)try{return JSON.parse(r).id}catch{return"unknown"}return"unknown"}async syncNow(){if(console.log("[SyncManager] Manual sync triggered"),!Ar.isOnline())throw new Error("Cannot sync while offline");return await this.processQueue()}async getPendingItems(){return await Ye.getPendingQueueItems()}async getFailedItems(){return await Ye.getFailedQueueItems()}}const Dr=new Yv,Zv=()=>{const[e,r]=C.useState([]),[s,n]=C.useState([]),[a,i]=C.useState(!0),[c,m]=C.useState(!1),[d,p]=C.useState("pending");C.useEffect(()=>{N();const g=Dr.addEventListener(v=>{(v.type==="sync-complete"||v.type==="queue-updated")&&N()});return()=>g()},[]);const N=async()=>{i(!0);try{const[g,v]=await Promise.all([Dr.getPendingItems(),Dr.getFailedItems()]);r(g),n(v)}catch(g){console.error("[PendingActions] Error loading items:",g)}finally{i(!1)}},y=async()=>{m(!0);try{await Dr.retryFailed(),await N()}catch(g){console.error("[PendingActions] Retry failed:",g),alert(`Failed to retry: ${g.message}`)}finally{m(!1)}},f=async()=>{m(!0);try{await Dr.syncNow(),await N()}catch(g){console.error("[PendingActions] Sync failed:",g),alert(`Failed to sync: ${g.message}`)}finally{m(!1)}},k=async g=>{if(confirm("Are you sure you want to delete this item? This action cannot be undone."))try{await Dr.clearFailedItem(g),await N()}catch(v){console.error("[PendingActions] Error clearing item:",v)}},S=g=>new Date(g).toLocaleString(),E=g=>{switch(g){case"expense":return t.jsx(Yt,{className:"w-5 h-5"});case"event":return t.jsx(Mt,{className:"w-5 h-5"});case"user":return t.jsx(rs,{className:"w-5 h-5"});default:return t.jsx(Yt,{className:"w-5 h-5"})}},_=g=>{switch(g){case"CREATE":return"bg-emerald-100 text-emerald-800";case"UPDATE":return"bg-blue-100 text-blue-800";case"DELETE":return"bg-red-100 text-red-800";case"APPROVE":return"bg-purple-100 text-purple-800";default:return"bg-gray-100 text-gray-800"}},w=g=>t.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:t.jsxs("div",{className:"flex items-start justify-between",children:[t.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[t.jsx("div",{className:"text-gray-600 mt-1",children:E(g.entity)}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[t.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${_(g.action)}`,children:g.action}),t.jsx("span",{className:"text-sm font-semibold text-gray-900 capitalize",children:g.entity})]}),t.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[g.entity==="expense"&&t.jsxs("div",{children:[t.jsx("span",{className:"font-medium",children:g.data.merchant||"Unknown"}),g.data.amount&&t.jsxs("span",{className:"ml-2 text-gray-500",children:["$",g.data.amount.toFixed(2)]})]}),g.entity==="event"&&t.jsx("div",{className:"font-medium",children:g.data.name||"Unnamed Event"}),g.entity==="user"&&t.jsx("div",{className:"font-medium",children:g.data.username||"Unknown User"})]}),t.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[t.jsxs("div",{className:"flex items-center space-x-1",children:[t.jsx(hr,{className:"w-3 h-3"}),t.jsx("span",{children:S(g.timestamp)})]}),g.retryCount>0&&t.jsxs("div",{className:"flex items-center space-x-1 text-amber-600",children:[t.jsx(Ir,{className:"w-3 h-3"}),t.jsxs("span",{children:[g.retryCount," retries"]})]})]}),g.error&&t.jsx("div",{className:"mt-2 p-2 bg-red-50 border border-red-200 rounded text-xs text-red-700",children:t.jsxs("div",{className:"flex items-start space-x-1",children:[t.jsx(st,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),t.jsx("span",{children:g.error})]})})]})]}),g.status==="failed"&&t.jsx("button",{onClick:()=>k(g.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete item",children:t.jsx(Ur,{className:"w-4 h-4"})})]})},g.id),j=d==="pending"?e:s;return t.jsx("div",{className:"min-h-screen bg-gray-50 p-4 md:p-6",children:t.jsxs("div",{className:"max-w-4xl mx-auto",children:[t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-900 mb-2",children:"Pending Actions"}),t.jsx("p",{className:"text-gray-600",children:"View and manage items waiting to sync with the server"})]}),t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:[t.jsx("div",{className:"border-b border-gray-200",children:t.jsxs("div",{className:"flex",children:[t.jsx("button",{onClick:()=>p("pending"),className:`
./backend/env.production.example:21:# Set to your frontend origin, e.g. https://expense.example.com
./backend/env.sandbox.template:29:CORS_ORIGIN=https://sandbox.expenseapp.example.com
./backend/env.sandbox.template:30:FRONTEND_URL=https://sandbox.expenseapp.example.com
./backend/env.production.template:31:CORS_ORIGIN=https://expenseapp.yourdomain.com
./backend/env.production.template:32:FRONTEND_URL=https://expenseapp.yourdomain.com
./docs/MASTER_GUIDE.md.backup:3334:https://accounts.zoho.com/oauth/v2/auth?scope=ZohoBooks.expenses.CREATE,ZohoBooks.expenses.READ,ZohoBooks.settings.READ,ZohoBooks.accountants.READ&client_id=YOUR_CLIENT_ID&response_type=code&redirect_uri=https://expapp.duckdns.org/auth/zoho/callback&access_type=offline&prompt=consent
./docs/MASTER_GUIDE.md.backup:3434:3. Verify in Zoho Books: `https://one.zoho.com/zohoone/boominbrands/home/cxapp/books/app/842978819#/expenses`
./docs/rename-external-urls.md:5:./dist/assets/index-C-FEraip.js:499:      `,children:e})},Ty=({expenses:e,onPageChange:r})=>{const s=e.slice(0,5);return t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-3 sm:p-4 sm:p-5 md:p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Recent Expenses"}),t.jsx("button",{onClick:()=>r("expenses"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"View All"})]}),s.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(kt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"No expenses yet"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Submit your first expense to get started"})]}):t.jsx("div",{className:"space-y-4",children:s.map(n=>t.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[t.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 md:space-x-4",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-emerald-500 rounded-full flex items-center justify-center",children:t.jsx(kt,{className:"w-5 h-5 text-white"})}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[t.jsx("p",{className:"font-medium text-gray-900",children:n.merchant}),n.event_name&&t.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-blue-100 text-blue-700 rounded-full text-xs font-medium",children:[t.jsx(Mt,{className:"w-3 h-3"}),n.event_name]})]}),t.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[t.jsx(hr,{className:"w-3 h-3"}),t.jsx("span",{children:xt(n.date)}),n.location&&t.jsxs(t.Fragment,{children:[t.jsx(Ls,{className:"w-3 h-3 ml-2"}),t.jsx("span",{children:n.location})]})]})]})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(mu,{category:n.category,size:"sm"}),t.jsx(ud,{status:n.status,size:"sm"}),t.jsxs("p",{className:"font-semibold text-gray-900",children:["$",n.amount.toFixed(2)]})]})]},n.id))})]})},Ry=({events:e,onPageChange:r})=>{const s=new Date;s.setHours(0,0,0,0);const n=e.filter(i=>or(i.endDate)>=s).sort((i,c)=>{const m=or(i.startDate),d=or(c.startDate);return m.getTime()-d.getTime()}).slice(0,3),a=i=>i===0?"Today":i===1?"1 day":`${i} days`;return t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Upcoming Events"}),t.jsx("button",{onClick:()=>r("events"),className:"text-blue-600 hover:text-blue-700 font-medium",children:"View All"})]}),n.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(Mt,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"No upcoming events"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create your first trade show event"})]}):t.jsx("div",{className:"space-y-4",children:n.map(i=>{var y;const c=or(i.startDate),m=or(i.endDate),d=new Date;d.setHours(0,0,0,0);const N=d>=c&&d<=m?0:ky(i.startDate);return t.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg hover:shadow-sm transition-shadow",children:[t.jsxs("div",{className:"flex items-start justify-between mb-3",children:[t.jsx("h4",{className:"font-semibold text-gray-900",children:i.name}),t.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${N===0?"bg-orange-100 text-orange-800":N<=7?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:a(N)})]}),t.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[t.jsxs("div",{className:"flex items-center",children:[t.jsx(Ls,{className:"w-4 h-4 mr-2"}),t.jsxs("span",{children:[i.venue,", ",i.city,", ",i.state]})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(hr,{className:"w-4 h-4 mr-2"}),t.jsx("span",{children:zx(i.startDate,i.endDate)})]}),t.jsxs("div",{className:"flex items-center",children:[t.jsx(Nr,{className:"w-4 h-4 mr-2"}),t.jsxs("span",{children:[((y=i.participants)==null?void 0:y.length)||0," participants"]})]})]}),i.budget&&t.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100",children:t.jsxs("div",{className:"flex items-center justify-between text-sm",children:[t.jsx("span",{className:"text-gray-600",children:"Budget"}),t.jsxs("span",{className:"font-medium text-gray-900",children:["$",i.budget.toLocaleString()]})]})})]},i.id)})})]})},Ay=({events:e,expenses:r})=>{const s=C.useMemo(()=>e.filter(a=>a.budget&&a.budget>0).map(a=>{const i=r.filter(p=>p.tradeShowId===a.id),c=i.reduce((p,N)=>p+N.amount,0),m=a.budget||0,d=m>0?c/m*100:0;return{...a,budget:m,totalSpent:c,budgetUsed:d,remaining:m-c,expenseCount:i.length}}).slice(0,4),[e,r]),n=a=>a>=90?{color:"red",status:"Critical",icon:bt}:a>=75?{color:"orange",status:"Warning",icon:bt}:{color:"emerald",status:"Good",icon:ut};return t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-3 sm:p-4 sm:p-5 md:p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsx("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Budget Overview"}),t.jsx(ts,{className:"w-5 h-5 text-blue-600"})]}),s.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx(ut,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),t.jsx("p",{className:"text-gray-500",children:"No budget data available"}),t.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Create events and add expenses to see budget tracking"})]}):t.jsx("div",{className:"space-y-6",children:s.map(a=>{const i=n(a.budgetUsed),c=i.icon;return t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-900",children:a.name}),t.jsxs("p",{className:"text-sm text-gray-600",children:[a.expenseCount," expenses submitted"]})]}),t.jsxs("div",{className:`flex items-center space-x-1 text-sm font-medium ${i.color==="red"?"text-red-600":i.color==="orange"?"text-orange-600":"text-emerald-600"}`,children:[t.jsx(c,{className:"w-4 h-4"}),t.jsx("span",{children:i.status})]})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{className:"text-gray-600",children:["Spent: $",a.totalSpent.toLocaleString()]}),t.jsxs("span",{className:"text-gray-600",children:["Budget: $",a.budget.toLocaleString()]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${i.color==="red"?"bg-red-500":i.color==="orange"?"bg-orange-500":"bg-emerald-500"}`,style:{width:`${Math.min(a.budgetUsed,100)}%`}})}),t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{className:`font-medium ${i.color==="red"?"text-red-600":i.color==="orange"?"text-orange-600":"text-emerald-600"}`,children:[a.budgetUsed.toFixed(1),"% used"]}),t.jsxs("span",{className:"text-gray-600",children:["$",a.remaining.toLocaleString()," remaining"]})]})]})]},a.id)})})]})},Dy=!0,se={USE_SERVER:Dy,login:async(e,r)=>{const s=await ge.post("/auth/login",{username:e,password:r});return s!=null&&s.token&&Vt.setToken(s.token),s},logout:()=>{Vt.removeToken()},getUsers:()=>ge.get("/users"),createUser:e=>ge.post("/users",e),updateUser:(e,r)=>ge.put(`/users/${e}`,r),deleteUser:e=>ge.delete(`/users/${e}`),getRoles:()=>ge.get("/roles"),createRole:e=>ge.post("/roles",e),updateRole:(e,r)=>ge.put(`/roles/${e}`,r),deleteRole:e=>ge.delete(`/roles/${e}`),getEvents:()=>ge.get("/events"),createEvent:e=>ge.post("/events",e),updateEvent:(e,r)=>ge.put(`/events/${e}`,r),deleteEvent:e=>ge.delete(`/events/${e}`),getExpenses:e=>ge.get("/expenses",{params:e}),createExpense:async(e,r)=>r?ge.upload("/expenses",e,r,"receipt"):ge.post("/expenses",e),updateExpense:async(e,r,s)=>s?ge.upload(`/expenses/${e}`,r,s,"receipt","PUT"):ge.put(`/expenses/${e}`,r),updateExpenseReceipt:async(e,r)=>ge.upload(`/expenses/${e}/receipt`,{},r,"receipt","PUT"),updateExpenseStatus:(e,r)=>ge.patch(`/expenses/${e}/status`,r),reviewExpense:(e,r)=>ge.patch(`/expenses/${e}/review`,r),assignEntity:(e,r)=>ge.patch(`/expenses/${e}/entity`,r),pushToZoho:e=>ge.post(`/expenses/${e}/push-to-zoho`,{}),setExpenseReimbursement:(e,r)=>ge.patch(`/expenses/${e}/reimbursement`,r),deleteExpense:e=>ge.delete(`/expenses/${e}`),downloadExpensePDF:async e=>{console.log("[downloadExpensePDF] Starting PDF download for expense:",e);const r=Vt.getToken();if(!r)throw new Error("Authentication required. Please log in again.");const s=ge.getBaseURL(),n=window.location.protocol,a=window.location.origin;let i=`${s}/expenses/${e}/pdf`;console.log("[downloadExpensePDF] URL info:",{baseURL:s,pdfUrl:i,currentProtocol:n,currentOrigin:a,isRelative:!i.startsWith("http")}),n==="https:"&&i.startsWith("http://")&&(i=i.replace("http://","https://"),console.warn("[downloadExpensePDF] Upgraded HTTP to HTTPS to avoid mixed content warning"));const c=navigator.userAgent.toLowerCase(),m=c.includes("arc")||c.includes("the browser company"),d=c.includes("chrome")&&!c.includes("edg");console.log("[downloadExpensePDF] Browser detection:",{isArc:m,isChrome:d,userAgent:c.substring(0,50)});try{console.log("[downloadExpensePDF] Fetching PDF from:",i);const p=await fetch(i,{method:"GET",headers:{Authorization:`Bearer ${r}`},credentials:"same-origin"});if(console.log("[downloadExpensePDF] Response status:",p.status,p.statusText),console.log("[downloadExpensePDF] Response headers:",{"content-type":p.headers.get("content-type"),"content-disposition":p.headers.get("content-disposition"),"content-length":p.headers.get("content-length"),"x-content-type-options":p.headers.get("x-content-type-options"),"x-download-options":p.headers.get("x-download-options")}),!p.ok){const F=await p.text();let T="Failed to download expense PDF";try{const R=JSON.parse(F);T=R.error||R.message||T}catch{T=F||T}throw console.error("[downloadExpensePDF] HTTP error:",p.status,T),new Error(T)}const N=p.headers.get("content-type");(!N||!N.includes("application/pdf"))&&(console.error("[downloadExpensePDF] Invalid Content-Type:",N),console.warn("[downloadExpensePDF] Expected application/pdf but got:",N));const y=p.headers.get("content-disposition");let f=`expense-${e}.pdf`;if(y){const F=y.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/);F&&F[1]&&(f=F[1].replace(/['"]/g,""))}console.log("[downloadExpensePDF] Filename:",f),console.log("[downloadExpensePDF] Converting response to blob...");const k=await p.blob();if(console.log("[downloadExpensePDF] Blob created:",{size:k.size,type:k.type}),k.size===0)throw new Error("Downloaded PDF is empty. Please try again.");const E=await k.slice(0,4).arrayBuffer(),_=new Uint8Array(E),w=String.fromCharCode(..._);if(console.log("[downloadExpensePDF] PDF header check:",{header:w,bytes:Array.from(_).map(F=>`0x${F.toString(16).padStart(2,"0")}`).join(" ")}),!w.startsWith("%PDF")){console.error("[downloadExpensePDF] Invalid PDF header. First 4 bytes:",w);try{const F=await k.text();console.error("[downloadExpensePDF] Response text (first 200 chars):",F.substring(0,200));try{const T=JSON.parse(F);throw new Error(T.error||T.message||"Downloaded file is not a valid PDF")}catch{throw new Error("Downloaded file is not a valid PDF. Please check server logs.")}}catch{throw new Error("Downloaded file is not a valid PDF. Please check server logs.")}}console.log("[downloadExpensePDF] PDF header validated successfully");const j=k.type==="application/pdf"?k:new Blob([k],{type:"application/pdf"});console.log("[downloadExpensePDF] PDF blob ready:",{size:j.size,type:j.type});const g=window.URL.createObjectURL(j);console.log("[downloadExpensePDF] Blob URL created:",g.substring(0,50)+"...");let v=null,A=!1;try{if(v=document.createElement("a"),v.href=g,v.download=f,v.style.display="none",v.setAttribute("rel","noopener noreferrer"),m&&(v.setAttribute("target","_self"),console.log("[downloadExpensePDF] Arc browser detected - using Arc-specific settings")),document.body.appendChild(v),console.log("[downloadExpensePDF] Link appended to DOM"),await new Promise(T=>setTimeout(T,m?100:50)),console.log("[downloadExpensePDF] Triggering download..."),typeof v.click=="function")v.click(),console.log("[downloadExpensePDF] Used link.click() method");else{const T=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0,buttons:1});v.dispatchEvent(T),console.log("[downloadExpensePDF] Used MouseEvent dispatch method")}A=!0,console.log("[downloadExpensePDF] Download triggered successfully"),setTimeout(()=>{try{v&&document.body.contains(v)&&(document.body.removeChild(v),console.log("[downloadExpensePDF] Link removed from DOM")),window.URL.revokeObjectURL(g),console.log("[downloadExpensePDF] Blob URL revoked")}catch(T){console.warn("[downloadExpensePDF] Cleanup error (non-critical):",T)}},m?2e3:1e3)}catch(F){if(console.error("[downloadExpensePDF] Error during download trigger:",F),v&&document.body.contains(v))try{document.body.removeChild(v)}catch(R){console.warn("[downloadExpensePDF] Error removing link:",R)}window.URL.revokeObjectURL(g);const T=F instanceof Error?F.message:"Unknown error";throw console.error("[downloadExpensePDF] Download failed:",T),new Error(`Failed to download PDF: ${T}. Please check your browser settings or try a different browser.`)}if(!A)throw new Error("Download trigger failed. Please check browser console for details.")}catch(p){throw console.error("[downloadExpensePDF] Fatal error:",p),p}},getSettings:()=>ge.get("/settings"),updateSettings:e=>ge.put("/settings",e),processReceiptWithOCR:async e=>{const r=Vt.getToken();if(!r)throw new Error("Authentication required. Please log in again.");const s=await fetch(`${ge.getBaseURL()}/ocr/v2/process`,{method:"POST",headers:{Authorization:`Bearer ${r}`},body:e});if(!s.ok){const n=await s.text();throw console.error("[OCR] Processing failed:",n),new Error("OCR processing failed")}return await s.json()},getBaseURL:()=>ge.getBaseURL(),register:e=>ge.post("/auth/register",e),checkAvailability:e=>ge.post("/auth/check-availability",e),quickActions:{getTasks:()=>ge.get("/quick-actions")},devDashboard:{getVersion:()=>ge.get("/dev-dashboard/version"),getMetrics:e=>ge.get("/dev-dashboard/metrics",{params:{timeRange:e}}),getAuditLogs:e=>ge.get("/dev-dashboard/audit-logs",{params:e}),getSessions:()=>ge.get("/dev-dashboard/sessions"),getApiAnalytics:e=>ge.get("/dev-dashboard/api-analytics",{params:{timeRange:e}}),getAlerts:(e,r)=>ge.get("/dev-dashboard/alerts",{params:{status:e,severity:r}}),acknowledgeAlert:e=>ge.post(`/dev-dashboard/alerts/${e}/acknowledge`),resolveAlert:e=>ge.post(`/dev-dashboard/alerts/${e}/resolve`),getPageAnalytics:e=>ge.get("/dev-dashboard/page-analytics",{params:{timeRange:e}}),getSummary:()=>ge.get("/dev-dashboard/summary"),getOcrMetrics:()=>ge.get("/dev-dashboard/ocr-metrics")},checklist:{getChecklist:e=>ge.get(`/checklist/${e}`),updateChecklist:(e,r)=>ge.put(`/checklist/${e}`,r),uploadBoothMap:async(e,r)=>{const s=new FormData;s.append("boothMap",r);const n=Vt.getToken(),a=await fetch(`${ge.getBaseURL()}/checklist/${e}/booth-map`,{method:"POST",headers:{Authorization:`Bearer ${n}`},body:s});if(!a.ok){const i=await a.text();throw new Error(i||"Failed to upload booth map")}return await a.json()},deleteBoothMap:e=>ge.delete(`/checklist/${e}/booth-map`),createFlight:(e,r)=>ge.post(`/checklist/${e}/flights`,r),updateFlight:(e,r)=>ge.put(`/checklist/flights/${e}`,r),deleteFlight:e=>ge.delete(`/checklist/flights/${e}`),createHotel:(e,r)=>ge.post(`/checklist/${e}/hotels`,r),updateHotel:(e,r)=>ge.put(`/checklist/hotels/${e}`,r),deleteHotel:e=>ge.delete(`/checklist/hotels/${e}`),createCarRental:(e,r)=>ge.post(`/checklist/${e}/car-rentals`,r),updateCarRental:(e,r)=>ge.put(`/checklist/car-rentals/${e}`,r),deleteCarRental:e=>ge.delete(`/checklist/car-rentals/${e}`),createBoothShipping:(e,r)=>ge.post(`/checklist/${e}/booth-shipping`,r),updateBoothShipping:(e,r)=>ge.put(`/checklist/booth-shipping/${e}`,r),deleteBoothShipping:e=>ge.delete(`/checklist/booth-shipping/${e}`),getCustomItems:e=>ge.get(`/checklist/${e}/custom-items`),createCustomItem:(e,r)=>ge.post(`/checklist/${e}/custom-items`,r),updateCustomItem:(e,r)=>ge.put(`/checklist/custom-items/${e}`,r),deleteCustomItem:e=>ge.delete(`/checklist/custom-items/${e}`),getTemplates:()=>ge.get("/checklist/templates"),createTemplate:e=>ge.post("/checklist/templates",e),updateTemplate:(e,r)=>ge.put(`/checklist/templates/${e}`,r),deleteTemplate:e=>ge.delete(`/checklist/templates/${e}`),applyTemplates:e=>ge.post(`/checklist/${e}/apply-templates`,{})}},My=({user:e,onNavigate:r})=>{const[s,n]=C.useState([]),[a,i]=C.useState(!0),[c,m]=C.useState(!1),d=async(f=!1)=>{f?m(!0):i(!0);try{const k=await se.quickActions.getTasks();n(k.tasks||[])}catch(k){console.error("Failed to load quick actions:",k)}finally{i(!1),m(!1)}};C.useEffect(()=>{d();const f=setInterval(()=>d(!0),6e4);return()=>clearInterval(f)},[]);const p=f=>({UserPlus:t.jsx(Ix,{className:"w-5 h-5"}),FileText:t.jsx(Yt,{className:"w-5 h-5"}),Upload:t.jsx(is,{className:"w-5 h-5"}),AlertTriangle:t.jsx(bt,{className:"w-5 h-5"}),Clock:t.jsx(hr,{className:"w-5 h-5"}),DollarSign:t.jsx(kt,{className:"w-5 h-5"})})[f]||t.jsx(Yt,{className:"w-5 h-5"}),N=f=>{switch(f){case"high":return"border-red-200 bg-red-50";case"medium":return"border-yellow-200 bg-yellow-50";default:return"border-blue-200 bg-blue-50"}},y=f=>{switch(f){case"high":return"bg-red-100 text-red-700";case"medium":return"bg-yellow-100 text-yellow-700";default:return"bg-blue-100 text-blue-700"}};return a?t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsx("div",{className:"flex items-center justify-between mb-4",children:t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"})}),t.jsx("div",{className:"flex items-center justify-center py-8",children:t.jsx("div",{className:"w-8 h-8 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})})]}):t.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Pending Tasks"}),t.jsx("button",{onClick:()=>d(!0),disabled:c,className:"p-2 text-gray-400 hover:text-gray-600 transition-colors disabled:opacity-50",title:"Refresh",children:t.jsx(Ir,{className:`w-4 h-4 ${c?"animate-spin":""}`})})]}),s.length===0?t.jsxs("div",{className:"text-center py-8",children:[t.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-3",children:t.jsx("svg",{className:"w-8 h-8 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:t.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),t.jsx("p",{className:"text-gray-600 font-medium",children:"All caught up!"}),t.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No pending tasks at the moment"})]}):t.jsx("div",{className:"space-y-3",children:s.map(f=>t.jsx("div",{className:`border-2 rounded-lg p-4 transition-all hover:shadow-md ${N(f.priority)}`,children:t.jsx("div",{className:"flex items-start justify-between",children:t.jsxs("div",{className:"flex items-start space-x-3 flex-1",children:[t.jsx("div",{className:`mt-1 ${f.priority==="high"?"text-red-600":f.priority==="medium"?"text-yellow-600":"text-blue-600"}`,children:p(f.icon)}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:f.title}),t.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${y(f.priority)}`,children:f.priority})]}),t.jsx("p",{className:"text-sm text-gray-600 mb-3",children:f.description}),t.jsxs("button",{onClick:()=>{const k=f.link.replace("/","");f.type==="pending_users"&&k==="settings"&&sessionStorage.setItem("openSettingsTab","users"),r(k)},className:`inline-flex items-center text-sm font-medium transition-colors ${f.priority==="high"?"text-red-600 hover:text-red-700":f.priority==="medium"?"text-yellow-600 hover:text-yellow-700":"text-blue-600 hover:text-blue-700"}`,children:[f.action,t.jsx(Ex,{className:"w-4 h-4 ml-1"})]})]})]})})},f.id))})]})},Fy=()=>{const[e,r]=C.useState(null),[s,n]=C.useState(!1),[a,i]=C.useState(!1);C.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches)return;const p=localStorage.getItem("pwa-install-dismissed");if(p){const y=parseInt(p);if((Date.now()-y)/(1e3*60*60*24)<7)return}const N=y=>{y.preventDefault(),r(y),n(!0),setTimeout(()=>{i(!0)},1e4)};return window.addEventListener("beforeinstallprompt",N),()=>{window.removeEventListener("beforeinstallprompt",N)}},[]);const c=async()=>{if(!e){alert(`To install this app:
./docs/DEPLOYMENT_PROXMOX.md:152:sed -i 's#BACKEND_UPSTREAM#http://<backend-container-ip>:5000#g' /etc/nginx/sites-available/expenseapp.conf
./docs/SETUP_GUIDE.md:185:curl -X POST http://localhost:5000/api/expenses \
./credentials/SANDBOX_CREDENTIALS.md:67:- **URL**: https://one.zoho.com/zohoone/hautebrands/home/cxapp/books/app/856048585#/expenses
./credentials/HAUTE_CREDENTIALS.md:36:- **URL**: https://one.zoho.com/zohoone/hautebrands/home/cxapp/books/app/856048585#/expenses
./credentials/CREDENTIALS_TEMPLATE.md:47:https://accounts.zoho.com/oauth/v2/auth?scope=ZohoBooks.expenses.CREATE,ZohoBooks.expenses.READ,ZohoBooks.settings.READ,ZohoBooks.accountants.READ&client_id=YOUR_CLIENT_ID&response_type=code&redirect_uri=https://expapp.duckdns.org/auth/zoho/callback&access_type=offline&prompt=consent
